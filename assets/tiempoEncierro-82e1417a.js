import{u as M,g as c,r as g,o as b,f as x,j as S,_ as N,m,n as P,b as f,a as z,l as B}from"./index-77660dd1.js";import{_ as L}from"./CHeaderBar-420a9954.js";import{_ as O}from"./CFilterbar-697d0ee8.js";import{_ as X}from"./subSideNav-4b706314.js";import{_ as Y}from"./CCard-f0f378fd.js";import{_ as H}from"./CColunmChart-2227accc.js";import"./CButton-f7aa2ad4.js";import"./CChartDonutSection-366c452d.js";const R={class:"chart-section-principal"},W={class:"tiempo-encierro"},j={class:"chart-section"},q=f("span",{class:"card-title"},"Pregunta",-1),J=f("span",{class:"question--value"},"6. ¿Cuánto tiempo lleva en esta cárcel?",-1),_=7,oe={__name:"tiempoEncierro",setup(G){const t=M(),n=c(!1),v=c("Trayectoria / ¿Cuánto tiempo lleva en esta cárcel?"),h=c(""),A=c({categories:["menos de 6 meses","entre 6 meses y 1 año","entre 1 y 2 años","más de 2 años","No asignado"],crosshair:!1}),w=c({min:0,allowDecimals:!1,title:{text:"Suma por categoría"}}),C=c({column:{pointPadding:.2,borderWidth:3}}),I=c({headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),T=e=>{let a=0,s=0,p=0,d=0,o=0,l=0,r=0;for(let i=0;i<e.length;i++)e[i].value===1&&(a++,l+=0,r++),e[i].value===2&&(s++,l+=1,r++),e[i].value===3&&(p++,l+=1.6,r++),e[i].value===4&&(d++,l+=2.6,r++),e[i].value===-1&&(o+=e[i].value*-1),h.value=V(l/r);return[a,s,p,d,o]},V=e=>e?Math.round(e*100)/100:0,u=g([]),$=(e,a,s)=>g({id:e,name:a,data:s,dataLabels:{enabled:!0,color:"#fff",align:"center",x:-15,style:{inside:!0,fontSize:"10px",fontFamily:"helvetica, arial, sans-serif",textShadow:!1,fontWeight:"normal"}}}),F=async e=>{n.value=!0;const a=u.filter(s=>s.id!==e);u.splice(0,u.length),a.map(s=>u.push(s)),await t.sleep(50),n.value=!1},y=async(e,a,s)=>{var p,d;try{let o=((p=t==null?void 0:t.penitenciaria)==null?void 0:p.id)??null,l=((d=t==null?void 0:t.penitenciaria)==null?void 0:d.description)??null,r=t.historyId;if(s&&(o=e,l=a),r&&o){n.value=!0;let E=await B({historyId:r,carcelId:o,categoryId:_,subCategoryId:23,embedDetail:!0,dimensionId:129});const k=T(E.items);u.push($(o,l,k))}}catch(o){console.log(o)}finally{s||(n.value=!1)}},D=async()=>{n.value=!0,t.carcelesSelected&&t.carcelesSelected.length>0&&await Promise.all(t.carcelesSelected.map(async e=>await y(e.id,e.description,!0))),n.value=!1};return(e,a)=>(b(),x(N,null,{default:S(()=>[m(L,{title:v.value,"section-value":_},null,8,["title"]),m(P,{"active-spin":n.value},null,8,["active-spin"]),m(O,{baseFilter:_,multipleDisabled:!1,onExecuteMount:D,onExecuteAction:y,onExecuteRemove:F}),f("div",R,[m(X,{class:"subsection-trayectoria",title:v.value,"section-value":_,pointValue:h.value,pointTitle:"6. ¿Cuánto tiempo lleva en esta cárcel?",pointSubtitle:"",type:1},null,8,["title","pointValue","pointTitle"]),f("div",W,[f("div",j,[n.value?z("",!0):(b(),x(H,{key:0,chartType:"bar",optionsAxisX:A.value,optionsAxisY:w.value,plotOptions:C.value,tooltip:I.value,series:u},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))]),m(Y,{class:"card-preguntas"},{default:S(()=>[q,J]),_:1})])])]),_:1}))}};export{oe as default};
