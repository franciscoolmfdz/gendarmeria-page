import{_ as T}from"./CButton-1f0b74cb.js";import{g as p,u as E,h as M,i as N,o as m,f as y,j as s,_ as L,k as j,l as x,m as o,c as g,a as v,n as U,b as n}from"./index-d5d29b93.js";import{_}from"./CChartDonutSection-be9d7933.js";import{_ as q}from"./CHeaderBar-c99abf49.js";import{_ as D}from"./CCard-fa753b4a.js";const z={key:0,class:"c-option-volver"},J={key:1,class:"principal-section section-internos"},K={class:"principal-section"},O={key:0,class:"principal-section__top top-position-one"},W=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),X=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),Y=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),Z=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),tt=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),et={key:1,class:"principal-section__top top-position-two"},st=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),ot=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),nt=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),at={class:"principal-section__bottom"},lt=n("span",{class:"sub-menu__option--title"},"Régimen carcelario",-1),it=n("span",{class:"sub-menu__option--text"},"Consulta sobre el régimen carcelario",-1),ut=n("span",{class:"sub-menu__option--title"},"Funcionamiento de la carcel",-1),ct=n("span",{class:"sub-menu__option--text"}," Consulta sobre funcionamiento de la carcel",-1),rt=n("span",{class:"sub-menu__option--title"},"Evaluación general",-1),_t=n("span",{class:"sub-menu__option--text"}," Consulta de evaluación general ",-1),dt=n("span",{class:"sub-menu__option--title"}," Infraestructura carcelaria",-1),pt=n("span",{class:"sub-menu__option--text"}," Consulta a los internos sobre la infraestructura carcelaria",-1),mt=n("span",{class:"sub-menu__option--title"},"Acceso a programas",-1),vt=n("span",{class:"sub-menu__option--text"}," Consulta a los internos sobre el acceso a programas de los internos",-1),bt=n("span",{class:"sub-menu__option--title"},"Trato con funcionarios",-1),ft=n("span",{class:"sub-menu__option--text"},"Consulta a los internos sobre la relación con los funcionarios",-1),ht=n("span",{class:"sub-menu__option--title"}," Cuestionario Salud GHQ-12 ",-1),gt=n("span",{class:"sub-menu__option--text"}," Consulta de resultados cuestionario de Salud GHQ-12 ",-1),Ct=1,Dt={__name:"VidaInternos",setup(yt){const H=p("Calidad de vida de los internos"),c=p(!1),I=E(),l=p([]),C=p(0),d=p(1),b=p(null),f=p(null),R=t=>t>0?Math.round(t*100)/100:0,$=()=>{d.value=0},w=async t=>{c.value=!0,d.value=t,c.value=!1},V=async()=>{let t={categoryId:1,lastPeriod:!0};return C.value||(C.value=await x(t)),t={categoryId:1,historyId:C.value.id},b.value&&(t.regionId=b.value),f.value&&(t.carcelId=f.value),t},B=async(t=2,a=8)=>{try{c.value=!0;const e=await V();let r=await j(e),i=null;for(let u=t;u<=a;u++){const A=u,k=r.filter(h=>h.subCategoryId===A&&h.valueUsed===1),Q=k.length;i=k.reduce((h,F)=>h+F.promPound,0),i=i/Q,i=R(i),l.value.push(i)}}catch(e){console.log(e)}},G=t=>{let a=t[0].recordId,e=0,r=0;for(let i=0;i<t.length;i++){let u=t[i];u.recordId==a&&u.pound>=0?(e+=u.pound,r+=u.value):(e=u.pound,a=u.recordId)}return r/t.length},P=t=>t?Math.round(t*100)/100:0,S=async()=>{try{let t=await V();c.value=!0;const a={...t,subCategoryId:21,embedDetail:!0};let e=await x(a);const r=G(e.items);l.value.push(P(r))}catch(t){console.log(t)}finally{c.value=!1}};return M(async()=>{c.value=!0;const t=I.user.restrictions.find(e=>e.typeId===2),a=I.user.restrictions.find(e=>e.typeId===3);t?b.value=parseInt(t.restriction):a?f.value=parseInt(a.restriction):(f.value=null,b.value=null),await B(),await S()}),(t,a)=>{const e=N("RouterLink");return m(),y(L,{class:"panel-vida-internos"},{default:s(()=>[o(q,{title:H.value,"section-value":Ct},null,8,["title"]),!c.value&&d.value!==0?(m(),g("div",z,[o(T,{class:"btn-volver",title:"Volver",onExecuteAction:$,disabled:t.blockButton},null,8,["disabled"])])):v("",!0),o(U,{"active-spin":c.value},null,8,["active-spin"]),!c.value&&l.value.length>0?(m(),g("div",J,[n("div",K,[d.value==1?(m(),g("div",O,[o(_,{class:"section-donut",title:"Infraestructura carcelaria",subtitle:"Consulta a los internos sobre la infraestructura carcelaria","point-value":l.value[0]},{default:s(()=>[o(e,{to:"vidaInternosInfraestructura",class:"sub-menu--option white btn-small"},{default:s(()=>[W]),_:1})]),_:1},8,["point-value"]),o(_,{class:"section-donut",title:"Acceso a programas",subtitle:"Consulta a los internos sobre el acceso a programas de los internos","point-value":l.value[1]},{default:s(()=>[o(e,{to:"accesoProgramas",class:"sub-menu--option white btn-small"},{default:s(()=>[X]),_:1})]),_:1},8,["point-value"]),o(_,{class:"section-donut",title:"Trato entre los internos",subtitle:"Consulta a los internos sobre la vida carcelaria","point-value":l.value[2]},{default:s(()=>[o(e,{to:"vidaInternosTrato",class:"sub-menu--option white btn-small"},{default:s(()=>[Y]),_:1})]),_:1},8,["point-value"]),o(_,{class:"section-donut",title:"Trato con funcionarios",subtitle:"Consulta a los internos sobre la relación con los funcionarios","point-value":l.value[3]},{default:s(()=>[o(e,{to:"vidaInternosFuncionario",class:"sub-menu--option white btn-small"},{default:s(()=>[Z]),_:1})]),_:1},8,["point-value"]),o(_,{class:"section-donut",title:"Cuestionario Salud GHQ-12",subtitle:"Consulta de resultados cuestionario de Salud GHQ-12",type:2,"point-value":l.value[7]},{default:s(()=>[o(e,{to:"cuestionarioGHQInterno",class:"sub-menu--option white btn-small"},{default:s(()=>[tt]),_:1})]),_:1},8,["point-value"])])):v("",!0),d.value==2?(m(),g("div",et,[o(_,{class:"section-donut",title:"Régimen carcelario",subtitle:"Consulta sobre el régimen carcelario","point-value":l.value[4]},{default:s(()=>[o(e,{to:"regimenCarcel",class:"sub-menu--option white btn-small"},{default:s(()=>[st]),_:1})]),_:1},8,["point-value"]),o(_,{class:"section-donut",title:"Funcionamiento de la carcel",subtitle:"Consulta sobre funcionamiento de la carcel","point-value":l.value[5]},{default:s(()=>[o(e,{to:"funcionamientoCarcel",class:"sub-menu--option white btn-small"},{default:s(()=>[ot]),_:1})]),_:1},8,["point-value"]),o(_,{class:"section-donut",title:"Evaluación general",subtitle:"Consulta de evaluación general","point-value":l.value[6]},{default:s(()=>[o(e,{to:"vidaInternosGeneral",class:"sub-menu--option white btn-small"},{default:s(()=>[nt]),_:1})]),_:1},8,["point-value"])])):v("",!0)]),n("div",at,[d.value!==2?(m(),y(D,{key:0,class:"card-information",onClick:a[0]||(a[0]=r=>w(2))},{default:s(()=>[o(e,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[lt,it]),_:1}),o(e,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[ut,ct]),_:1}),o(e,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[rt,_t]),_:1})]),_:1})):v("",!0),d.value!==1?(m(),y(D,{key:1,class:"card-information",onClick:a[1]||(a[1]=r=>w(1))},{default:s(()=>[o(e,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[dt,pt]),_:1}),o(e,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[mt,vt]),_:1}),o(e,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[bt,ft]),_:1}),o(e,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[ht,gt]),_:1})]),_:1})):v("",!0)])])):v("",!0)]),_:1})}}};export{Dt as default};
