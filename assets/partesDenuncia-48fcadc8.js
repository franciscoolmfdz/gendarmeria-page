import{_ as X}from"./CColunmChart-c9b61f21.js";import{u as Y,g as o,r as H,h as j,o as d,f as w,j as U,_ as q,x as G,l as D,b as f,m as i,n as K,c as M,C as Q,a as _,e as W,y as Z}from"./index-f62bec79.js";import{_ as ee}from"./CHeaderBar-768ede49.js";import{_ as ae}from"./subSideNav-a149f5ab.js";import{_ as x}from"./CButton-49b6c568.js";import{_ as te}from"./CTable-be98243d.js";import{s as oe}from"./filterSituacion-5abea756.js";import"./CChartDonutSection-340f5160.js";const se={class:"content-header-partes"},le={key:0,class:"selected-options"},ne={key:1,class:"c-option-volver"},re={class:"table-section-principal"},ie={class:"content__section"},ce={class:"chart-section"},b=3,V=32,we={__name:"partesDenuncia",setup(de){const l=oe(),m=Y(),r=o(!1),n=o({id:15,description:"Región Metropolitana de Santiago"}),g=o([]),y=o(0),u=o(null),p=o(null),c=o(""),R=o(""),S=o("Estado situación carcelaria / Partes denuncia ley 20.000"),P=o([{description:"Centro penitenciario",colspan:1},{description:R,colspan:12},{description:"Resumen",colspan:3}]),$=o([{rowReference:"establecimiento",description:"Establecimiento"},{rowReference:"dataEnero",description:"1"},{rowReference:"dataFebrero",description:"2"},{rowReference:"dataMarzo",description:"3"},{rowReference:"dataAbril",description:"4"},{rowReference:"dataMayo",description:"5"},{rowReference:"dataJunio",description:"6"},{rowReference:"dataJulio",description:"7"},{rowReference:"dataAgosto",description:"8"},{rowReference:"dataSeptiembre",description:"9"},{rowReference:"dataOctubre",description:"10"},{rowReference:"dataNoviembre",description:"11"},{rowReference:"dataDiciembre",description:"12"},{rowReference:"otros",description:"Otros"},{rowReference:"leyVeinteMil",description:"Ley 20.000"},{rowReference:"total",description:"Total"}]),h=o([]),O=o({}),E=o({}),F=o({series:{allowPointSelect:!0,showInLegend:!0,cursor:"pointer",dataLabels:{enabled:!0,distance:-40,format:"{point.percentage:.1f}%",style:{fontSize:"1.2em",textOutline:"none",opacity:.7},filter:{operator:">",property:"percentage",value:10}}}}),k=o({}),v=H([{name:"Totales",colorByPoint:!0,data:[]}]),J=()=>{W.push("/situacionCarcelaria")},L=async()=>{l.changeRegionSelected(n.value),await I(),await A()},T=async a=>{if(!l.listadoRegiones.length>0){let t={regionId:null};u.value&&(t.regionId=u.value);let s=await G(t);g.value=s,l.setRegionesList(s)}else g.value=l.listadoRegiones},I=async()=>{let a=await Z();l.setCarcelesList(a)},B=async()=>{var t,s;let a={categoryId:b,historySubCategoryId:V,lastPeriod:!0};return y.value||(y.value=await D(a)),a={categoryId:b,historySubCategoryId:V,historyId:y.value.id,embedLawParts:!0},n.value?a.regionId=(t=n.value)!=null&&t.id?n.value.id:n.value:(s=l==null?void 0:l.regionSelected)!=null&&s.id&&(a.regionId=l.regionSelected.id,n.value=l.regionSelected),p.value&&(a.carcelId=p.value),await I(),a},A=async()=>{try{let a=0,t=0;c.value=0;const s=await B(),C=await D(s);R.value=`Año ${C.period}`,h.value=C.items.map(e=>{const N=l.listadoCarceles.find(z=>z.id==e.carcelId);return e.establecimiento=N.description,e.total=e.dataEnero+e.dataFebrero+e.dataMarzo+e.dataAbril+e.dataMayo+e.dataJunio+e.dataJulio+e.dataAgosto+e.dataSeptiembre+e.dataOctubre+e.dataNoviembre+e.dataDiciembre,e.otros=e.total-e.leyVeinteMil,a+=e.leyVeinteMil,e.dataEnero={class:"color-mes",data:e.dataEnero},e.dataFebrero={class:"color-mes",data:e.dataFebrero},e.dataMarzo={class:"color-mes",data:e.dataMarzo},e.dataAbril={class:"color-mes",data:e.dataAbril},e.dataMayo={class:"color-mes",data:e.dataMayo},e.dataJunio={class:"color-mes",data:e.dataJunio},e.dataJulio={class:"color-mes",data:e.dataJulio},e.dataAgosto={class:"color-mes",data:e.dataAgosto},e.dataSeptiembre={class:"color-mes",data:e.dataSeptiembre},e.dataOctubre={class:"color-mes",data:e.dataOctubre},e.dataNoviembre={class:"color-mes",data:e.dataNoviembre},e.dataDiciembre={class:"color-mes",data:e.dataDiciembre},t+=e.otros,c.value+=e.total,e.total={class:"color-mes",data:e.total},e}),c.value=`Total: ${c.value}`,v[0].data=[],v[0].data.push({name:"Otros",y:t}),v[0].data.push({name:"Ley 20.000",y:a})}catch(a){console.log(a)}};return j(async()=>{r.value=!0,n.value=l.regionSelected;const a=m.user.restrictions.find(s=>s.typeId===2),t=m.user.restrictions.find(s=>s.typeId===3);a?u.value=parseInt(a.restriction):t?p.value=parseInt(t.restriction):(p.value=null,u.value=null),n.value=l.regionSelected.value,await T(),await A(),r.value=!1}),(a,t)=>(d(),w(q,{class:"contenido-partes"},{default:U(()=>[f("div",se,[i(ee,{title:S.value,"section-value":b},null,8,["title"]),i(K,{"active-spin":r.value},null,8,["active-spin"]),r.value?_("",!0):(d(),M("div",le,[r.value?_("",!0):(d(),w(Q,{key:0,class:"select-region",options:g.value,modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=s=>n.value=s)},null,8,["options","modelValue"])),i(x,{class:"btn-search",title:"",onExecuteAction:t[1]||(t[1]=s=>L())})])),!r.value&&a.topPosition!==0?(d(),M("div",ne,[i(x,{class:"btn-volver",title:"Volver",onExecuteAction:J,disabled:a.blockButton},null,8,["disabled"])])):_("",!0)]),f("div",re,[i(ae,{class:"subsection-partes",title:S.value,"section-value":b,"point-label":c.value,pointTitle:"Partes denuncia ley 20.000",pointSubtitle:"","point-disabled":!0},null,8,["title","point-label"]),f("div",ie,[i(te,{"parent-columns":P.value,columns:$.value,rows:h.value},null,8,["parent-columns","columns","rows"]),f("div",ce,[r.value?_("",!0):(d(),w(X,{key:0,chartType:"pie",optionsAxisX:O.value,optionsAxisY:E.value,plotOptions:F.value,tooltip:k.value,series:v},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))])])])]),_:1}))}};export{we as default};
