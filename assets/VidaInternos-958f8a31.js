import{_ as Q}from"./CButton-1d70cd49.js";import{g as m,u as T,h as E,i as N,o as v,f as k,j as s,_ as L,k as j,l as R,m as o,c as y,a as f,n as U,b as n}from"./index-c8938612.js";import{_ as d}from"./CChartDonutSection-e94e3819.js";import{_ as q}from"./CHeaderBar-52290071.js";import{_ as $}from"./CCard-96aa4865.js";const z={key:0,class:"c-option-volver"},J={key:1,class:"principal-section section-internos"},K={class:"principal-section"},O={key:0,class:"principal-section__top top-position-one"},W=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),X=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),Y=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),Z=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),tt={key:1,class:"principal-section__top top-position-two"},et=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),st=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),ot=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),nt=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),at={class:"principal-section__bottom"},lt=n("span",{class:"sub-menu__option--title"},"Régimen de la Cárcel",-1),it=n("span",{class:"sub-menu__option--text"},"Consulta sobre el régimen carcelario",-1),ut=n("span",{class:"sub-menu__option--title"},"Funcionamiento de la carcel",-1),ct=n("span",{class:"sub-menu__option--text"}," Consulta sobre funcionamiento de la carcel",-1),rt=n("span",{class:"sub-menu__option--title"},"Evaluación general",-1),_t=n("span",{class:"sub-menu__option--text"}," Consulta de evaluación general ",-1),dt=n("span",{class:"sub-menu__option--title"}," Cuestionario Salud GHQ-12 ",-1),pt=n("span",{class:"sub-menu__option--text"}," Consulta de resultados cuestionario de Salud GHQ-12 ",-1),mt=n("span",{class:"sub-menu__option--title"},"Infraestructura de la Cárcel",-1),vt=n("span",{class:"sub-menu__option--text"}," Consulta a los internos sobre la infraestructura carcelaria",-1),bt=n("span",{class:"sub-menu__option--title"},"Acceso a programas",-1),ft=n("span",{class:"sub-menu__option--text"}," Consulta a los internos sobre el acceso a programas de los internos",-1),ht=n("span",{class:"sub-menu__option--title"},"Trato con otros Internos(as)",-1),gt=n("span",{class:"sub-menu__option--text"},"Consulta a los internos sobre la vida carcelaria",-1),Ct=n("span",{class:"sub-menu__option--title"},"Trato interpersonal Funcionario-Interno",-1),It=n("span",{class:"sub-menu__option--text"},"Consulta a los internos sobre la relación con los funcionarios",-1),yt=1,Rt={__name:"VidaInternos",setup(wt){const B=m("Calidad de vida de los internos"),r=m(!1),x=T(),l=m([]),w=m(0),p=m(1),g=m(null),C=m(null),F=e=>e>0?Math.round(e*100)/100:0,G=()=>{p.value=0},D=async e=>{r.value=!0,p.value=e,r.value=!1},H=async()=>{let e={categoryId:1,lastPeriod:!0};return w.value||(w.value=await R(e)),e={categoryId:1,historyId:w.value.id},g.value&&(e.regionId=g.value),C.value&&(e.carcelId=C.value),e},M=async(e=2,a=8)=>{try{r.value=!0;const t=await H();let _=await j(t),u=null;for(let c=e;c<=a;c++){const V=c,b=_.filter(i=>i.subCategoryId===V&&i.valueUsed===1),h=b.length;u=b.reduce((i,A)=>i+A.valuePound,0),u=u/h,u=F(u),l.value.push(u)}}catch(t){console.log(t)}},P=e=>{let a=e[0].recordId,t=0,_=0,u=0,c=0,V=0;for(let h=0;h<e.length;h++){let i=e[h];i.recordId==a&&i.pound>=0?(c+=i.pound,V+=i.value):(c<2?t++:c>2&&c<=6?_++:c>6&&u++,c=i.pound,a=i.recordId)}const b=t+_+u;return Math.max(Math.round(I(t/b*100)),Math.round(I(_/b*100)),Math.round(I(u/b*100)))},I=e=>e?Math.round(e*100)/100:0,S=async()=>{try{let e=await H();r.value=!0;const a={...e,subCategoryId:21,embedDetail:!0};let t=await R(a);const _=P(t.items);l.value.push(I(_))}catch(e){console.log(e)}finally{r.value=!1}};return E(async()=>{r.value=!0;const e=x.user.restrictions.find(t=>t.typeId===2),a=x.user.restrictions.find(t=>t.typeId===3);e?g.value=parseInt(e.restriction):a?C.value=parseInt(a.restriction):(C.value=null,g.value=null),await M(),await S()}),(e,a)=>{const t=N("RouterLink");return v(),k(L,{class:"panel-vida-internos"},{default:s(()=>[o(q,{title:B.value,"section-value":yt},null,8,["title"]),!r.value&&p.value!==0?(v(),y("div",z,[o(Q,{class:"btn-volver",title:"Volver",onExecuteAction:G,disabled:e.blockButton},null,8,["disabled"])])):f("",!0),o(U,{"active-spin":r.value},null,8,["active-spin"]),!r.value&&l.value.length>0?(v(),y("div",J,[n("div",K,[p.value==1?(v(),y("div",O,[o(d,{class:"section-donut",title:"Infraestructura de la Cárcel",subtitle:"Consulta a los internos sobre la infraestructura carcelaria","point-value":l.value[0]},{default:s(()=>[o(t,{to:"vidaInternosInfraestructura",class:"sub-menu--option white btn-small"},{default:s(()=>[W]),_:1})]),_:1},8,["point-value"]),o(d,{class:"section-donut",title:"Acceso a programas",subtitle:"Consulta a los internos sobre el acceso a programas de los internos","point-value":l.value[1]},{default:s(()=>[o(t,{to:"accesoProgramas",class:"sub-menu--option white btn-small"},{default:s(()=>[X]),_:1})]),_:1},8,["point-value"]),o(d,{class:"section-donut",title:"Trato con otros Internos(as)",subtitle:"Consulta a los internos sobre la vida carcelaria","point-value":l.value[2]},{default:s(()=>[o(t,{to:"vidaInternosTrato",class:"sub-menu--option white btn-small"},{default:s(()=>[Y]),_:1})]),_:1},8,["title","point-value"]),o(d,{class:"section-donut",title:"Trato interpersonal Funcionario-Interno",subtitle:"Consulta a los internos sobre la relación con los funcionarios","point-value":l.value[3]},{default:s(()=>[o(t,{to:"vidaInternosFuncionario",class:"sub-menu--option white btn-small"},{default:s(()=>[Z]),_:1})]),_:1},8,["point-value"])])):f("",!0),p.value==2?(v(),y("div",tt,[o(d,{class:"section-donut",title:"Régimen de la Cárcel",subtitle:"Consulta sobre el régimen carcelario","point-value":l.value[4]},{default:s(()=>[o(t,{to:"regimenCarcel",class:"sub-menu--option white btn-small"},{default:s(()=>[et]),_:1})]),_:1},8,["point-value"]),o(d,{class:"section-donut",title:"Funcionamiento de la carcel",subtitle:"Consulta sobre funcionamiento de la carcel","point-value":l.value[5]},{default:s(()=>[o(t,{to:"funcionamientoCarcel",class:"sub-menu--option white btn-small"},{default:s(()=>[st]),_:1})]),_:1},8,["point-value"]),o(d,{class:"section-donut",title:"Evaluación general",subtitle:"Consulta de evaluación general","point-value":l.value[6]},{default:s(()=>[o(t,{to:"vidaInternosGeneral",class:"sub-menu--option white btn-small"},{default:s(()=>[ot]),_:1})]),_:1},8,["point-value"]),o(d,{class:"section-donut",title:"Cuestionario Salud GHQ-12",subtitle:"Consulta de resultados cuestionario de Salud GHQ-12",type:2,"point-value":l.value[7],"is-percent":!0},{default:s(()=>[o(t,{to:"cuestionarioGHQInterno",class:"sub-menu--option white btn-small"},{default:s(()=>[nt]),_:1})]),_:1},8,["point-value"])])):f("",!0)]),n("div",at,[p.value!==2?(v(),k($,{key:0,class:"card-information",onClick:a[0]||(a[0]=_=>D(2))},{default:s(()=>[o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[lt,it]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[ut,ct]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[rt,_t]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[dt,pt]),_:1})]),_:1})):f("",!0),p.value!==1?(v(),k($,{key:1,class:"card-information",onClick:a[1]||(a[1]=_=>D(1))},{default:s(()=>[o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[mt,vt]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[bt,ft]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[ht,gt]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[Ct,It]),_:1})]),_:1})):f("",!0)])])):f("",!0)]),_:1})}}};export{Rt as default};
