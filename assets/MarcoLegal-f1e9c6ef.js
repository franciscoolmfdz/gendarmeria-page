import{r as i,o as v,c as F,a as f,i as $,s as x,d as h,w as _,_ as A,b as d,p as N,K as V}from"./index-4bf4a7de.js";import{_ as E}from"./CHeaderBar-922b50aa.js";import{_ as M,a as S,b as k}from"./CSection-35558c31.js";import{_ as D}from"./CTable-28ef051b.js";import{s as P}from"./marcoLegalStore-844d5015.js";const U={__name:"CFileManagement",props:{modelValue:{type:[String,Object],default:""}},emits:["update:modelValue"],setup(o,{emit:n}){const s=i(null);i(""),i("");const e=t=>{var a,u;if((a=t.target)!=null&&a.files&&((u=t.target)==null?void 0:u.files.length)>0){const c=t.target.files[0];n("update:modelValue",c)}};return(t,a)=>(v(),F("div",null,[f("input",{type:"file",ref_key:"fileInput",ref:s,onChange:a[0]||(a[0]=u=>e(u))},null,544)]))}},j="https://apiserver-production-091b.up.railway.app/api",y=async(o,n,s,e)=>{try{const t=`${j}${o}`;let a=null;if(n==="GET"){if(e!=null&&e.download)return`${t}/download`;a={method:n,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":(e==null?void 0:e.contentType)??"application/json"}}}else if(n==="PATCH"||n==="POST"||n==="PUT"||n==="DELETE"){a={method:n,mode:"cors",cache:"no-cache",credentials:"same-origin",referrerPolicy:"no-referrer"};let c=null;e!=null&&e.ignoreHeader?a.body=s:e!=null&&e.defineContentType?(c={"Content-Type":e==null?void 0:e.defineContentType},a.headers=c):(c={"Content-Type":"application/json"},a.headers=c,a.body=JSON.stringify(s))}else throw new exeption(`Accion ${n} invalida para llamada Api.`);return(await fetch(t,a)).json()}catch(t){console.log(t)}},w="/fmr/files",B=async(o,n)=>{if(o!=null&&o.id){let s=`${w}/${o.id}`;return y(s,"GET",null,n)}return y(w,"GET",null,n)},I=async(o,n)=>y(w,"POST",o,n),g={getFiles:B,postFiles:I};const L=f("i",{class:"large material-icons"},"arrow_upward",-1),O={class:"content-document__section"},J={__name:"MarcoLegal",setup(o){const n=i(),s=i(null),e=i([{rowReference:"name",description:"Nombre archivo"},{rowReference:"createdAt",description:"Fecha de carga"}]);P();const t=i(),a=()=>[{name:"descargar",iconName:"pageview"},{name:"borrar",iconName:"delete_forever"}],u=()=>{console.log("Modal closed")},c=()=>{const l=new FormData;l.append("archivo",s.value),l.append("categoryId",1),l.append("usrId",1);const r={ignoreHeader:!0};g.postFiles(l,r)},C=()=>{console.log(n.value.open())},T=async l=>{if(l.actionName==="descargar"){const r={id:l.request.id},p={download:!0},m=await g.getFiles(r,p);window.open(m,"_blank")}else l.actionName};$(async()=>{let l=await g.getFiles();t.value=l,t.value.map(r=>(r.actions=a(),r))});const b=i("Marco legal");return(l,r)=>{const p=x("router-view");return v(),h(A,null,{default:_(()=>[d(E,{title:b.value},null,8,["title"]),f("button",{onClick:C,class:"btn agregar__archivo"},[N("Agregar registro "),L]),d(k,{ref_key:"modalForm",ref:n,title:"Subir documento",onClose:u,onSubmit:r[1]||(r[1]=m=>c())},{default:_(()=>[d(M,null,{default:_(()=>[d(S,null,{default:_(()=>[d(U,{modelValue:s.value,"onUpdate:modelValue":r[0]||(r[0]=m=>s.value=m)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512),f("div",O,[d(p,null,{default:_(({Component:m})=>[(v(),h(V,null,[d(D,{columns:e.value,rows:t.value,"actions-active":"",onExecuteActionlist:T},null,8,["columns","rows"])],1024))]),_:1})])]),_:1})}}};export{J as default};
