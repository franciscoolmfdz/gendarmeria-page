import{r as u,y as D,i as V,h as O,o as i,c as d,a as p,j as E,q as K,z as f,F as A,k as F,m as g,A as N,x as P,t as $,n as j,B as z,C as M}from"./index-67a02a72.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const q=r=>(z("data-v-78cd2695"),r=r(),M(),r),H={class:"c-search"},T={class:"search__content"},G=["onKeydown"],J={key:0,class:"search__content--results"},Q=["onClick"],R={key:0},W=j('<div class="search--spinner" data-v-78cd2695><div class="preloader-wrapper small active" data-v-78cd2695><div class="spinner-layer spinner-green-only" data-v-78cd2695><div class="circle-clipper left" data-v-78cd2695><div class="circle" data-v-78cd2695></div></div><div class="gap-patch" data-v-78cd2695><div class="circle" data-v-78cd2695></div></div><div class="circle-clipper right" data-v-78cd2695><div class="circle" data-v-78cd2695></div></div></div></div></div>',1),X=[W],Y={class:"search__cleaner"},Z=q(()=>p("i",{class:"Small material-icons"},"clear",-1)),ee=[Z],te={__name:"CSearch",props:{options:{type:Array,default:null},asyncOptionsPromise:{type:Function,default:null},modelValue:{type:[String,Object],default:""}},emits:["update:modelValue"],setup(r,{emit:_}){const n=r,S=e=>{const t=l=>{const c=l.target;!c||c===document.documentElement||c===document.body||c.closest(".c-search")||e()};V(()=>{document.addEventListener("click",t)}),N(()=>{document.removeEventListener("click",t)})},a=u(""),s=u([]),o=u(-1),h=u(!1),m=u(!0),w=e=>{s.value=n.options.filter(t=>(t.description||t).toLowerCase().includes(e.toLowerCase())),k()},x=async e=>{h.value=!0;try{const t=await n.asyncOptionsPromise(e);s.value=t,k()}catch(t){console.error(t)}h.value=!1},I=e=>{a.value=e.description||e,s.value=[],_("update:modelValue",e),v()},y=()=>{a.value="",s.value=[],_("update:modelValue",""),v()},L=async()=>{o.value=-1,a.value?n.asyncOptionsPromise?await x(a.value):w(a.value):y()},b=()=>{if(o.value!==-1&&s.value.length>0){const e=s.value[o.value];a.value=e.description||e,s.value=[],_("update:modelValue",e),v()}},B=D(()=>a.value!==""),C=e=>{s.value.length!==0&&(e==="down"?o.value=(o.value+1)%s.value.length:e==="up"&&(o.value=(o.value-1+s.value.length)%s.value.length))},v=()=>{m.value=!0},k=()=>{m.value=!1};return V(()=>{var e;S(v),n.modelValue&&(a.value=((e=n.modelValue)==null?void 0:e.description)||n.modelValue)}),O(()=>n.options,()=>{a.value?w(a.value):(s.value=[],y())}),O(()=>n.modelValue,e=>{a.value=e?e.description||e:""}),(e,t)=>(i(),d("div",H,[p("div",T,[E(p("input",{class:"search__content--text","onUpdate:modelValue":t[0]||(t[0]=l=>a.value=l),placeholder:"buscar...",type:"text",onInput:L,onKeydown:[t[1]||(t[1]=f(l=>C("down"),["down"])),t[2]||(t[2]=f(l=>C("up"),["up"])),f(b,["enter"])]},null,40,G),[[K,a.value]]),m.value?g("",!0):(i(),d("ul",J,[(i(!0),d(A,null,F(s.value,(l,c)=>(i(),d("li",{key:c,class:P({active:c===o.value}),onClick:ae=>I(l)},$(l.description||l),11,Q))),128))]))]),h.value?(i(),d("div",R,X)):g("",!0),p("div",Y,[B.value?(i(),d("button",{key:0,class:"search__cleaner--btn red teal lighten-5",onClick:y},ee)):g("",!0)])]))}},ne=U(te,[["__scopeId","data-v-78cd2695"]]);export{ne as C};
