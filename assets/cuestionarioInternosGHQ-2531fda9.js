import{u as k,g as n,r as w,o as V,f as G,j as D,_ as q,m as h,n as E,b as r,a as R,l as T}from"./index-fc26754b.js";import{_ as B}from"./subSideNav-9ffd3689.js";import{_ as L}from"./CCard-6c2e717d.js";import{_ as N}from"./CHeaderBar-9b96237c.js";import{_ as O}from"./CFilterbar-81f2a423.js";import{_ as X}from"./CColunmChart-24a48a66.js";import"./CChartDonutSection-0ec9d6f0.js";import"./CButton-8ab6f89a.js";const Y={class:"chart-section-principal"},z={class:"cuestionario-ghq"},W={class:"chart-section"},j=r("span",{class:"card-title"},"Escala de evaluación",-1),J=r("span",{class:"question--value"},"Ausencia de psicopatología: De 0 a 2 puntos.",-1),K=r("span",{class:"question--value"},"Sospecha de psicopatología: 3 a 6 puntos.",-1),U=r("span",{class:"question--value"},"Indicativo de presencia de psicopatología: 7 ó mas puntos.",-1),y=1,re={__name:"cuestionarioInternosGHQ",setup(Z){const s=k(),l=n(!1),b=n("Calidad de vida de los internos / Cuestionario de Salud GHQ-12 de Goldberg"),_=n([]),x=n(0),A=n({categories:["Ausencia","Sospecha","Presencia"],crosshair:!1}),C=n({min:0,allowDecimals:!1,title:{text:""}}),H=n({column:{pointPadding:.2,borderWidth:3}}),F=n({headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),c=w([]),P=(e,o,t)=>w({id:e,name:o,data:t,dataLabels:{enabled:!0,color:"#000",align:"center",x:11,pointFormat:'<tr><td style="padding:0"><b>{point.y}%</b></td></tr>',style:{inside:!1,fontSize:"10px",fontFamily:"helvetica, arial, sans-serif",textShadow:!1,fontWeight:"normal"}}}),$=async e=>{l.value=!0;const o=c.filter(t=>t.id!==e);_.value=_.value.filter(t=>t.carcelId!=e),S(),c.splice(0,c.length),o.map(t=>c.push(t)),await s.sleep(50),l.value=!1},f=e=>e?Math.round(e*100)/100:0,S=()=>{let e=_.value.reduce((o,t)=>o+t.pointValue,0);e=e/_.value.length,e=f(e),x.value=e.toString()},M=e=>{let o=e[0].recordId,t=0,u=0,d=0,a=0,p=0,m=0;for(let v=0;v<e.length;v++){let i=e[v];i.recordId==o&&i.pound>=0?(a+=i.pound,p+=i.value,m++):(a<2?t++:a>2&&a<=6?u++:a>6&&d++,a=i.pound,o=i.recordId)}p=(p+1.3)/m;const g=t+u+d;return[Math.round(f(t/g*100)),Math.round(f(u/g*100)),Math.round(f(d/g*100))]},I=async(e,o,t)=>{var u,d;try{let a=((u=s==null?void 0:s.penitenciaria)==null?void 0:u.id)??null,p=((d=s==null?void 0:s.penitenciaria)==null?void 0:d.description)??null,m=s.historyId;if(t&&(a=e,p=o),m&&a){l.value=!0;let v=await T({historyId:m,carcelId:a,categoryId:1,subCategoryId:21,embedDetail:!0});const i=M(v.items);_.value.push({carcelId:a,pointValue:f(Math.max(...i))}),S(),c.push(P(a,p,i))}}catch(a){console.log(a)}finally{t||(l.value=!1)}},Q=async()=>{l.value=!0,s.carcelesSelected&&s.carcelesSelected.length>0&&await Promise.all(s.carcelesSelected.map(async e=>await I(e.id,e.description,!0))),l.value=!1};return(e,o)=>(V(),G(q,null,{default:D(()=>[h(N,{title:b.value,"section-value":y},null,8,["title"]),h(E,{"active-spin":l.value},null,8,["active-spin"]),h(O,{baseFilter:y,multipleDisabled:!1,onExecuteMount:Q,onExecuteAction:I,onExecuteRemove:$}),r("div",Y,[h(B,{title:b.value,"section-value":y,pointValue:x.value,pointTitle:"Cuestionario General de Salud GHQ-12 de Goldberg",pointSubtitle:"Promedio respuestas cuestionario General de Salud GHQ-12 de Goldberg","point-is-percent":!0,"point-type":2},null,8,["title","pointValue"]),r("div",z,[r("div",W,[l.value?R("",!0):(V(),G(X,{key:0,chartType:"bar",optionsAxisX:A.value,optionsAxisY:C.value,plotOptions:H.value,tooltip:F.value,series:c},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))]),h(L,{class:"card-preguntas"},{default:D(()=>[j,J,K,U]),_:1})])])]),_:1}))}};export{re as default};
