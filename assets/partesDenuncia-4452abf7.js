import{_ as Y}from"./CColunmChart-e60147cf.js";import{u as z,g as o,r as H,h as J,o as f,f as y,j,_ as U,x as q,l as V,b as u,m as r,n as G,C as K,a as w,c as Q,e as W,y as Z}from"./index-5f425c6a.js";import{_ as ee}from"./CHeaderBar-ae039085.js";import{_ as te}from"./subSideNav-60745070.js";import{_ as P}from"./CButton-9b8ff62a.js";import{_ as oe}from"./CTable-583262ee.js";import{s as ae}from"./filterSituacion-00ed8337.js";import"./CChartDonutSection-09a7c30d.js";const se={class:"content-header-partes"},ie={class:"selected-options"},ne={key:0,class:"c-option-volver"},le={class:"table-section-principal"},re={class:"content__section"},ce={class:"chart-section"},m=3,$=32,we={__name:"partesDenuncia",setup(ue){const s=ae(),b=z(),l=o(!1),i=o({id:15,description:"Región Metropolitana de Santiago"}),_=o([]),g=o(0),d=o(null),p=o(null),c=o(""),R=o(""),h=o("Estado situación carcelaria / Partes denuncia ley 20.000"),D=o([{description:"Centro penitenciario",colspan:1},{description:R,colspan:12},{description:"Resumen",colspan:3}]),A=o([{rowReference:"establecimiento",description:"Establecimiento"},{rowReference:"dataEnero",description:"1"},{rowReference:"dataFebrero",description:"2"},{rowReference:"dataMarzo",description:"3"},{rowReference:"dataAbril",description:"4"},{rowReference:"dataMayo",description:"5"},{rowReference:"dataJunio",description:"6"},{rowReference:"dataJulio",description:"7"},{rowReference:"dataAgosto",description:"8"},{rowReference:"dataSeptiembre",description:"9"},{rowReference:"dataOctubre",description:"10"},{rowReference:"dataNoviembre",description:"11"},{rowReference:"dataDiciembre",description:"12"},{rowReference:"otros",description:"Otros"},{rowReference:"leyVeinteMil",description:"Ley 20.000"},{rowReference:"total",description:"Total"}]),I=o([]),L=o({}),T=o({}),k=o({series:{allowPointSelect:!0,showInLegend:!0,cursor:"pointer",dataLabels:{enabled:!0,distance:-40,format:"{point.percentage:.1f}%",style:{fontSize:"1.2em",textOutline:"none",opacity:.7},filter:{operator:">",property:"percentage",value:10}}}}),B=o({}),v=H([{name:"Totales",colorByPoint:!0,data:[]}]),M=()=>{W.push("/situacionCarcelaria")},O=async()=>{s.changeRegionSelected(i.value),await S(),await C()},E=async e=>{if(!s.listadoRegiones.length>0){let t={regionId:null};d.value&&(t.regionId=d.value);let a=await q(t);_.value=a,s.setRegionesList(a)}else _.value=s.listadoRegiones},S=async()=>{let e=await Z();s.setCarcelesList(e)},F=async()=>{var t,a;let e={categoryId:m,historySubCategoryId:$,lastPeriod:!0};return g.value||(g.value=await V(e)),e={categoryId:m,historySubCategoryId:$,historyId:g.value.id,embedLawParts:!0},i.value?e.regionId=(t=i.value)!=null&&t.id?i.value.id:i.value:(a=s==null?void 0:s.regionSelected)!=null&&a.id&&(e.regionId=s.regionSelected.id,i.value=s.regionSelected),p.value&&(e.carcelId=p.value),await S(),e},C=async()=>{try{let e=0,t=0;c.value=0;const a=await F(),x=await V(a);R.value=`Año ${x.period}`,I.value=x.items.map(n=>{const N=s.listadoCarceles.find(X=>X.id==n.carcelId);return n.establecimiento=N.description,n.otros=n.total-n.leyVeinteMil,e+=n.leyVeinteMil,t+=n.otros,c.value+=n.total,n}),c.value=`Total: ${c.value}`,v[0].data=[],v[0].data.push({name:"Otros",y:t}),v[0].data.push({name:"Ley 20.000",y:e})}catch(e){console.log(e)}};return J(async()=>{l.value=!0,i.value=s.regionSelected;const e=b.user.restrictions.find(a=>a.typeId===2),t=b.user.restrictions.find(a=>a.typeId===3);e?d.value=parseInt(e.restriction):t?p.value=parseInt(t.restriction):(p.value=null,d.value=null),i.value=s.regionSelected.value,await E(),await C(),l.value=!1}),(e,t)=>(f(),y(U,{class:"contenido-partes"},{default:j(()=>[u("div",se,[r(ee,{title:h.value,"section-value":m},null,8,["title"]),r(G,{"active-spin":l.value},null,8,["active-spin"]),u("div",ie,[l.value?w("",!0):(f(),y(K,{key:0,class:"select-region",options:_.value,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=a=>i.value=a)},null,8,["options","modelValue"])),r(P,{class:"btn-search",title:"",onExecuteAction:t[1]||(t[1]=a=>O())})]),!l.value&&e.topPosition!==0?(f(),Q("div",ne,[r(P,{class:"btn-volver",title:"Volver",onExecuteAction:M,disabled:e.blockButton},null,8,["disabled"])])):w("",!0)]),u("div",le,[r(te,{class:"subsection-partes",title:h.value,"section-value":m,"point-label":c.value,pointTitle:"Partes denuncia ley 20.000",pointSubtitle:"","point-disabled":!0},null,8,["title","point-label"]),u("div",re,[r(oe,{"parent-columns":D.value,columns:A.value,rows:I.value},null,8,["parent-columns","columns","rows"]),u("div",ce,[l.value?w("",!0):(f(),y(Y,{key:0,chartType:"pie",optionsAxisX:L.value,optionsAxisY:T.value,plotOptions:k.value,tooltip:B.value,series:v},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))])])])]),_:1}))}};export{we as default};
