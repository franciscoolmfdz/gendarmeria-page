import{o as p,c as m,t as V,r as v,j as A,g as k,k as w,v as I,F as D,l as F,a as y,m as L,d as x,n as M,f as S,b as g,p as q,i as E}from"./index-a88dcf22.js";import{b as j,a as O}from"./dimensionHistory-b6bfb333.js";const P=["disabled"],B={__name:"CButton",props:{title:{type:String,required:!0},disabled:{type:Boolean,default:!1}},emits:["executeAction"],setup(i,{emit:d}){return(s,t)=>(p(),m("button",{class:"c-button",onClick:t[0]||(t[0]=n=>d("executeAction")),disabled:i.disabled},V(i.title),9,P))}};const R=y("option",{value:""},"Seleccionar opción",-1),U=["value"],H={__name:"CSelect",props:{options:{type:Array,required:!0},modelValue:{type:[Object,Number],default:null}},emits:["update:modelValue"],setup(i,{emit:d}){const s=i,t=v(s.modelValue?s.modelValue.id:null);return A(()=>s.modelValue,n=>{t.modelValue=n?n.id:""}),A(t,n=>{d("update:modelValue",n)}),k(()=>{var n;s.modelValue&&(t.modelValue=((n=s.modelValue)==null?void 0:n.id)||s.modelValue)}),(n,_)=>w((p(),m("select",{class:"c-select","onUpdate:modelValue":_[0]||(_[0]=r=>t.value=r)},[R,(p(!0),m(D,null,F(i.options,r=>(p(),m("option",{value:r.id,key:r.id},V(r.description),9,U))),128))],512)),[[I,t.value]])}},$={id:16,description:"CCP Colina 1"},T=L("filters",()=>{const i=v(null),d=v(),s=v($),t=x([$]),n=x([]);v(!1);function _(e){e!=null&&e.periodo&&(i.value=(e==null?void 0:e.periodo)??null),e!=null&&e.penitenciaria&&(e.penitenciaria.historyId=d.value,s.value=e==null?void 0:e.penitenciaria,t.find(f=>f.id===e.penitenciaria.id&&f.historyId===e.penitenciaria.historyId)||t.push(e==null?void 0:e.penitenciaria))}function r(e){n.value=e??[]}function c(e){i.value=(e==null?void 0:e.periodo)??null,d.value=(e==null?void 0:e.id)??null,t[0].historyId=e.id}function b(e){return new Promise(f=>setTimeout(f,e))}function h(){n.filter(e=>!isNaN(t.find(f=>f.id===e.id)))}function C(){d.value=null}return{historyId:d,periodo:i,penitenciaria:s,listadoCarceles:n,carcelesSelected:t,sleep:b,changeCriteria:_,mountListCarceles:r,mountBaseHistory:c,cleanHistory:C,removeCarcelesSelected:h}});const X={class:"c-filterbar"},z={class:"selected-options"},G={key:0,class:"selected-centros"},le={__name:"CFilterbar",props:{baseFilter:{type:[Object,Number,String],required:!0},multipleDisabled:{type:Boolean,default:!0},monthDisabled:{type:Boolean,default:!1}},emits:["executeAction","executeRemove","executeMount"],setup(i,{emit:d}){const s=i,t=T(),n=v("Buscar"),_=v(!1),r=v(t.penitenciaria),c=x([]),b=v(t.periodo),h=u=>{const l=c.filter(o=>o.id===u);e.value.push(l[0]),e.value.sort((o,N)=>o.id<N.id);const a=c.filter(o=>o.id!==u);c.splice(0,c.length),a.map(o=>c.push(o)),d("executeRemove",u)},C=async()=>{const u=e.value.filter(o=>o.id===r.value)[0];s.multipleDisabled||(c.push(u),e.value=e.value.filter(o=>o.id!==u.id),t.removeCarcelesSelected());const l=b.value.split("-"),a={year:l[0],month:l[1],categoryId:s.baseFilter};await f(a),t.changeCriteria({periodo:b.value,penitenciaria:u}),d("executeAction")},e=v(t.listadoCarceles),f=async u=>{_.value=!0;const l=await O(u);if(_.value=!1,l&&(l!=null&&l.period)&&(l!=null&&l.id)){const{period:a=null,id:o=null}=l;t.mountBaseHistory({period:a,id:o}),b.value=a}else t.cleanHistory()};return k(async()=>{var l;s.multipleDisabled||(n.value="Agregar a la búsqueda");const u={lastPeriod:!0,categoryId:s.baseFilter};if(await f(u),!e.value||e.value.length===0){const a=await j();t.mountListCarceles(a),(l=t.penitenciaria)!=null&&l.id&&!s.multipleDisabled?(c.splice(0,c.length),t.carcelesSelected.map(o=>c.push(o)),e.value=a.filter(o=>o.id!==t.penitenciaria.id),t.removeCarcelesSelected()):e.value=a}s.multipleDisabled?d("executeAction"):d("executeMount")}),(u,l)=>(p(),m("div",X,[y("div",z,[i.monthDisabled?S("",!0):w((p(),m("input",{key:0,class:"periodo-item",type:"month","onUpdate:modelValue":l[0]||(l[0]=a=>b.value=a)},null,512)),[[M,b.value]]),g(H,{options:e.value,modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=a=>r.value=a)},null,8,["options","modelValue"]),g(B,{title:n.value,onExecuteAction:C,disabled:_.value},null,8,["title","disabled"])]),i.multipleDisabled?S("",!0):(p(),m("div",G,[(p(!0),m(D,null,F(c,a=>(p(),m("div",null,[y("span",null,V(a.description),1),g(B,{title:"X",onExecuteAction:o=>h(a.id)},null,8,["onExecuteAction"])]))),256))]))]))}};const J={class:"card"},K={class:"card-stacked"},Q={class:"card-content"},W={key:0,class:"card-action"},Y=E('<div class="row"><a class="col s6 m1 waves-effect waves-light btn amber"><li class="material-icons">edit</li></a><a class="col s6 m1 waves-effect waves-light btn red darken-3"><li class="material-icons">delete</li></a></div>',1),Z=[Y],se={__name:"CCard",props:{actionACtive:{type:Boolean,default:!1}},setup(i){return(d,s)=>(p(),m("div",J,[y("div",K,[y("div",Q,[q(d.$slots,"default")]),i.actionACtive?(p(),m("div",W,Z)):S("",!0)])]))}};export{le as _,se as a,T as u};
