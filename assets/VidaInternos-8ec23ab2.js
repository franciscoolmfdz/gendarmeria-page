import{_ as T}from"./CButton-40472355.js";import{g as b,u as E,h as M,i as N,o as v,f as w,j as e,_ as L,k as j,l as P,m as s,c as I,a as f,n as U,b as n}from"./index-68f8bedd.js";import{_ as r}from"./CChartDonutSection-1bb06b2b.js";import{_ as q}from"./CHeaderBar-15eb3a90.js";import{_ as R}from"./CCard-428d3126.js";const z={key:0,class:"c-option-volver"},J={key:1,class:"principal-section section-internos"},K={class:"principal-section"},O={key:0,class:"principal-section__top top-position-one"},W=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),X=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),Y=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),Z=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),tt=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),et={key:1,class:"principal-section__top top-position-two"},st=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),ot=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),nt=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),at=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),lt={class:"principal-section__bottom"},it=n("span",{class:"sub-menu__option--title"},"Información personal",-1),ut=n("span",{class:"sub-menu__option--text"}," Consulta sobre información personal de internos ",-1),ct=n("span",{class:"sub-menu__option--title"},"Régimen carcelario",-1),rt=n("span",{class:"sub-menu__option--text"},"Consulta sobre el régimen carcelario",-1),_t=n("span",{class:"sub-menu__option--title"},"Funcionamiento de la carcel",-1),dt=n("span",{class:"sub-menu__option--text"}," Consulta sobre funcionamiento de la carcel",-1),pt=n("span",{class:"sub-menu__option--title"},"Evaluación general",-1),mt=n("span",{class:"sub-menu__option--text"}," Consulta de evaluación general ",-1),bt=n("span",{class:"sub-menu__option--title"}," Infraestructura carcelaria",-1),vt=n("span",{class:"sub-menu__option--text"}," Consulta a los internos sobre la infraestructura carcelaria",-1),ft=n("span",{class:"sub-menu__option--title"},"Acceso a programas",-1),ht=n("span",{class:"sub-menu__option--text"}," Consulta a los internos sobre el acceso a programas de los internos",-1),gt=n("span",{class:"sub-menu__option--title"},"Trato con funcionarios",-1),Ct=n("span",{class:"sub-menu__option--text"},"Consulta a los internos sobre la relación con los funcionarios",-1),It=n("span",{class:"sub-menu__option--title"}," Cuestionario Salud GHQ-12 ",-1),yt=n("span",{class:"sub-menu__option--text"}," Consulta de resultados cuestionario de Salud GHQ-12 ",-1),wt=1,Dt={__name:"VidaInternos",setup(Vt){const D=b("Calidad de vida de los internos"),c=b(!1),V=E(),u=b([]),y=b(0),d=b(0),h=b(null),g=b(null),G=o=>o>0?Math.round(o*100)/100:0,$=()=>{d.value=0},k=async o=>{c.value=!0,d.value=o,c.value=!1},x=async()=>{let o={categoryId:1,lastPeriod:!0};return y.value||(y.value=await P(o)),o={categoryId:1,historyId:y.value.id},h.value&&(o.regionId=h.value),g.value&&(o.carcelId=g.value),o},B=async(o=2,a=8)=>{try{c.value=!0;const t=await x();let p=await j(t),l=null;for(let i=o;i<=a;i++){const m=i,_=p.filter(C=>C.subCategoryId===m&&C.valueUsed===1),A=_.length;l=_.reduce((C,F)=>C+F.promPound,0),l=l/A,l=G(l),u.value.push(l)}}catch(t){console.log(t)}},Q=o=>{let a=o[0].recordId,t=0,p=0,l=0,i=0;for(let m=0;m<o.length;m++){let _=o[m];_.recordId==a&&_.pound>=0?i+=_.pound:(i<2?t++:i>2&&i<=6?p++:i>6&&l++,i=_.pound,a=_.recordId)}return[t,p,l]},H=o=>o?Math.round(o*100)/100:0,S=async()=>{try{let o=await x();c.value=!0;const a={...o,subCategoryId:21,embedDetail:!0};let t=await P(a),l=Q(t.items).reduce((i,m)=>i+m);l=H(l/3),u.value.push(H(l/12))}catch(o){console.log(o)}finally{c.value=!1}};return M(async()=>{c.value=!0;const o=V.user.restrictions.find(t=>t.typeId===2),a=V.user.restrictions.find(t=>t.typeId===3);o?h.value=parseInt(o.restriction):a?g.value=parseInt(a.restriction):(g.value=null,h.value=null),await B(),await S()}),(o,a)=>{const t=N("RouterLink");return v(),w(L,{class:"panel-vida-internos"},{default:e(()=>[s(q,{title:D.value,"section-value":wt},null,8,["title"]),!c.value&&d.value!==0?(v(),I("div",z,[s(T,{class:"btn-volver",title:"Volver",onExecuteAction:$,disabled:o.blockButton},null,8,["disabled"])])):f("",!0),s(U,{"active-spin":c.value},null,8,["active-spin"]),!c.value&&u.value.length>0?(v(),I("div",J,[n("div",K,[d.value==1?(v(),I("div",O,[s(r,{class:"section-donut",title:"Infraestructura carcelaria",subtitle:"Consulta a los internos sobre la infraestructura carcelaria","point-value":u.value[0]},{default:e(()=>[s(t,{to:"accesoProgramas",class:"sub-menu--option white btn-small"},{default:e(()=>[W]),_:1})]),_:1},8,["point-value"]),s(r,{class:"section-donut",title:"Acceso a programas",subtitle:"Consulta a los internos sobre el acceso a programas de los internos","point-value":u.value[1]},{default:e(()=>[s(t,{to:"accesoProgramas",class:"sub-menu--option white btn-small"},{default:e(()=>[X]),_:1})]),_:1},8,["point-value"]),s(r,{class:"section-donut",title:"Trato entre los internos",subtitle:"Consulta a los internos sobre la vida carcelaria","point-value":u.value[2]},{default:e(()=>[s(t,{to:"vidaInternosTrato",class:"sub-menu--option white btn-small"},{default:e(()=>[Y]),_:1})]),_:1},8,["point-value"]),s(r,{class:"section-donut",title:"Trato con funcionarios",subtitle:"Consulta a los internos sobre la relación con los funcionarios","point-value":u.value[3]},{default:e(()=>[s(t,{to:"vidaInternosFuncionario",class:"sub-menu--option white btn-small"},{default:e(()=>[Z]),_:1})]),_:1},8,["point-value"]),s(r,{class:"section-donut",title:"Cuestionario Salud GHQ-12",subtitle:"Consulta de resultados cuestionario de Salud GHQ-12",type:2,"point-value":u.value[7]},{default:e(()=>[s(t,{to:"cuestionarioGHQInterno",class:"sub-menu--option white btn-small"},{default:e(()=>[tt]),_:1})]),_:1},8,["point-value"])])):f("",!0),d.value==2?(v(),I("div",et,[s(r,{class:"section-donut",title:"Información personal",subtitle:"Consulta sobre información personal de internos","point-value":0},{default:e(()=>[s(t,{to:"vidaInternosPersonal",class:"sub-menu--option white btn-small"},{default:e(()=>[st]),_:1})]),_:1}),s(r,{class:"section-donut",title:"Régimen carcelario",subtitle:"Consulta sobre el régimen carcelario","point-value":u.value[4]},{default:e(()=>[s(t,{to:"regimenCarcel",class:"sub-menu--option white btn-small"},{default:e(()=>[ot]),_:1})]),_:1},8,["point-value"]),s(r,{class:"section-donut",title:"Funcionamiento de la carcel",subtitle:"Consulta sobre funcionamiento de la carcel","point-value":u.value[5]},{default:e(()=>[s(t,{to:"funcionamientoCarcel",class:"sub-menu--option white btn-small"},{default:e(()=>[nt]),_:1})]),_:1},8,["point-value"]),s(r,{class:"section-donut",title:"Evaluación general",subtitle:"Consulta de evaluación general","point-value":u.value[6]},{default:e(()=>[s(t,{to:"vidaInternosGeneral",class:"sub-menu--option white btn-small"},{default:e(()=>[at]),_:1})]),_:1},8,["point-value"])])):f("",!0)]),n("div",lt,[d.value!==2?(v(),w(R,{key:0,class:"card-information",onClick:a[0]||(a[0]=p=>k(2))},{default:e(()=>[s(t,{to:"#",class:"sub-menu--option options-bottom"},{default:e(()=>[it,ut]),_:1}),s(t,{to:"#",class:"sub-menu--option options-bottom"},{default:e(()=>[ct,rt]),_:1}),s(t,{to:"#",class:"sub-menu--option options-bottom"},{default:e(()=>[_t,dt]),_:1}),s(t,{to:"#",class:"sub-menu--option options-bottom"},{default:e(()=>[pt,mt]),_:1})]),_:1})):f("",!0),d.value!==1?(v(),w(R,{key:1,class:"card-information",onClick:a[1]||(a[1]=p=>k(1))},{default:e(()=>[s(t,{to:"#",class:"sub-menu--option options-bottom"},{default:e(()=>[bt,vt]),_:1}),s(t,{to:"#",class:"sub-menu--option options-bottom"},{default:e(()=>[ft,ht]),_:1}),s(t,{to:"#",class:"sub-menu--option options-bottom"},{default:e(()=>[gt,Ct]),_:1}),s(t,{to:"#",class:"sub-menu--option options-bottom"},{default:e(()=>[It,yt]),_:1})]),_:1})):f("",!0)])])):f("",!0)]),_:1})}}};export{Dt as default};
