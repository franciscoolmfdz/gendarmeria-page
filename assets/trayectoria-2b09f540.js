import{_ as L}from"./CButton-a3569a76.js";import{g as r,u as j,r as q,h as G,i as K,o as d,f as V,j as l,_ as O,l as w,m as a,c as h,a as v,n as Q,b as i}from"./index-45ccebc1.js";import{_ as p}from"./CChartDonutSection-a9b194f7.js";import{_ as U}from"./CHeaderBar-26ed6fbc.js";import{_ as x}from"./CCard-67b7bef7.js";const W={key:0,class:"c-option-volver"},X={key:1,class:"principal-section section-internos"},Y={class:"principal-section"},Z={key:0,class:"principal-section__top top-position-one"},D=i("span",{class:"sub-menu__option--title"}," Ver más ",-1),ee=i("span",{class:"sub-menu__option--title"}," Ver más ",-1),te=i("span",{class:"sub-menu__option--title"}," Ver más ",-1),oe=i("span",{class:"sub-menu__option--title"}," Ver más ",-1),ne={key:1,class:"principal-section__top top-position-two"},se=i("span",{class:"sub-menu__option--title"}," Ver más ",-1),le=i("span",{class:"sub-menu__option--title"}," Ver más ",-1),ae=i("span",{class:"sub-menu__option--title"}," Ver más ",-1),ie={class:"principal-section__bottom"},ue=i("span",{class:"sub-menu__option--title"},"5. Reincidencia en la Cárcel",-1),ce=i("span",{class:"sub-menu__option--text"},null,-1),_e=i("span",{class:"sub-menu__option--title"},"6. Tiempo en Cárcel",-1),re=i("span",{class:"sub-menu__option--text"},null,-1),de=i("span",{class:"sub-menu__option--title"},"7.Año para salir en libertad",-1),pe=i("span",{class:"sub-menu__option--text"},null,-1),ve=i("span",{class:"sub-menu__option--title"}," 1. Edad del Interno",-1),me=i("span",{class:"sub-menu__option--text"},null,-1),fe=i("span",{class:"sub-menu__option--title"},"2. Residió en Sename cuando niño",-1),be=i("span",{class:"sub-menu__option--text"},null,-1),he=i("span",{class:"sub-menu__option--title"},"3. Nivel educacional (en la calle)",-1),ge=i("span",{class:"sub-menu__option--text"},null,-1),ye=i("span",{class:"sub-menu__option--title"},"4. ¿Es chileno?",-1),Ve=i("span",{class:"sub-menu__option--text"},null,-1),ke=1,Me={__name:"trayectoria",setup(Ce){const E=r("Trayectoria de los internos"),c=r(!1),k=j(),u=r([0,0,0,0,0,0]),g=r(0),_=r(1),m=r(null),f=r(null),R=()=>{_.value=1},M=e=>{let o=0,t=0;for(let n=0;n<e.length;n++)e[n].value>0&&(o+=e[n].value,t++);u.value[0]=Math.round(o/t)},A=e=>{let o=0,t=0;for(let s=0;s<e.length;s++)e[s].value===1&&o++,e[s].value===-1&&(t+=e[s].value*-1);const n=e.length-t;u.value[1]=Math.round(b(o*100/n))},$=e=>{let o=0,t=0;for(let s=0;s<e.length;s++)e[s].value===-1?t+=e[s].value*-1:o+=e[s].value;const n=e.length-t;u.value[2]=Math.round(o/n)},N=e=>{let o=0,t=0;for(let s=0;s<e.length;s++)e[s].value===1&&o++,e[s].value===-1&&(t+=e[s].value*-1);const n=e.length-t;u.value[3]=Math.round(b(o*100/n))},B=e=>{let o=0,t=0;for(let s=0;s<e.length;s++)e[s].value===1&&o++,e[s].value===-1&&(t+=e[s].value*-1);const n=e.length-t;u.value[4]=Math.round(b(o*100/n))},T=e=>{let o=0,t=0;for(let n=0;n<e.length;n++)e[n].value===1&&(o+=0,t++),e[n].value===2&&(o+=1,t++),e[n].value===3&&(o+=1.6,t++),e[n].value===4&&(o+=2.6,t++);u.value[5]=Math.round(b(o/t))},P=e=>{let o=0,t=0;for(let n=0;n<e.length;n++)e[n].value===1&&(o+=2022,t++),e[n].value===2&&(o+=2023,t++),e[n].value===3&&(o+=2024,t++),e[n].value===4&&(o+=2025,t++);u.value[6]=Math.round(o/t)};q([]);const C=async e=>{c.value=!0,_.value=e,c.value=!1},S=async()=>{let e={categoryId:7,lastPeriod:!0};return g.value||(g.value=await w(e)),e={categoryId:7,historyId:g.value.id,embedDetail:!0,subCategoryId:23},m.value&&(e.regionId=m.value),f.value&&(e.carcelId=f.value),e},z=(e,o)=>{o===124&&M(e),o===125&&A(e),o===126&&$(e),o===127&&N(e),o===128&&B(e),o===129&&T(e),o===130&&P(e)},H=async(e=124,o=130)=>{try{c.value=!0;const t=await S();let n=await w(t),s=null;for(let y=e;y<=o;y++){const I=y,F=n.items.filter(J=>J.dimensionId===I);z(F,I)}}catch(t){console.log(t)}},b=e=>e?Math.round(e*100)/100:0;return G(async()=>{c.value=!0;const e=k.user.restrictions.find(t=>t.typeId===2),o=k.user.restrictions.find(t=>t.typeId===3);e?m.value=parseInt(e.restriction):o?f.value=parseInt(o.restriction):(f.value=null,m.value=null),await H(),c.value=!1}),(e,o)=>{const t=K("RouterLink");return d(),V(O,{class:"panel-trayectoria-internos"},{default:l(()=>[a(U,{title:E.value,"section-value":ke},null,8,["title"]),!c.value&&_.value!==0?(d(),h("div",W,[a(L,{class:"btn-volver",title:"Volver",onExecuteAction:R,disabled:e.blockButton},null,8,["disabled"])])):v("",!0),a(Q,{"active-spin":c.value},null,8,["active-spin"]),!c.value&&u.value.length>0?(d(),h("div",X,[i("div",Y,[_.value==1?(d(),h("div",Z,[a(p,{class:"section-donut",title:"1. Edad del Interno",subtitle:"","point-value":u.value[0],type:2},{default:l(()=>[a(t,{to:"edadInternos",class:"sub-menu--option white btn-small"},{default:l(()=>[D]),_:1})]),_:1},8,["title","point-value"]),a(p,{class:"section-donut",title:"2. Residió en Sename cuando niño",subtitle:"","point-value":u.value[1],type:2},{default:l(()=>[a(t,{to:"hogarMenores",class:"sub-menu--option white btn-small"},{default:l(()=>[ee]),_:1})]),_:1},8,["title","point-value"]),a(p,{class:"section-donut",title:"3. Nivel educacional (en la calle)",subtitle:"","point-value":u.value[2],type:2},{default:l(()=>[a(t,{to:"nivelEducacional",class:"sub-menu--option white btn-small"},{default:l(()=>[te]),_:1})]),_:1},8,["title","point-value"]),a(p,{class:"section-donut",title:"4. Nacionalidad del Interno",subtitle:"","point-value":u.value[3],type:2},{default:l(()=>[a(t,{to:"nacionalidadChilena",class:"sub-menu--option white btn-small"},{default:l(()=>[oe]),_:1})]),_:1},8,["title","point-value"])])):v("",!0),_.value==2?(d(),h("div",ne,[a(p,{class:"section-donut",title:"5. Reincidencia en la Cárcel",subtitle:"","point-value":u.value[4],type:2},{default:l(()=>[a(t,{to:"trayectoriaReinsidencia",class:"sub-menu--option white btn-small"},{default:l(()=>[se]),_:1})]),_:1},8,["title","point-value"]),a(p,{class:"section-donut",title:"6. Tiempo en Cárcel",subtitle:"","point-value":u.value[5],type:2},{default:l(()=>[a(t,{to:"tiempoEncierro",class:"sub-menu--option white btn-small"},{default:l(()=>[le]),_:1})]),_:1},8,["title","point-value"]),a(p,{class:"section-donut",title:"7. Año para salir en libertad",subtitle:"","point-value":u.value[6],type:2},{default:l(()=>[a(t,{to:"terminoEncierro",class:"sub-menu--option white btn-small"},{default:l(()=>[ae]),_:1})]),_:1},8,["title","point-value"])])):v("",!0)]),i("div",ie,[_.value!==2?(d(),V(x,{key:0,class:"card-information",onClick:o[0]||(o[0]=n=>C(2))},{default:l(()=>[a(t,{to:"#",class:"sub-menu--option options-bottom"},{default:l(()=>[ue,ce]),_:1}),a(t,{to:"#",class:"sub-menu--option options-bottom"},{default:l(()=>[_e,re]),_:1}),a(t,{to:"#",class:"sub-menu--option options-bottom"},{default:l(()=>[de,pe]),_:1})]),_:1})):v("",!0),_.value!==1?(d(),V(x,{key:1,class:"card-information",onClick:o[1]||(o[1]=n=>C(1))},{default:l(()=>[a(t,{to:"#",class:"sub-menu--option options-bottom"},{default:l(()=>[ve,me]),_:1}),a(t,{to:"#",class:"sub-menu--option options-bottom"},{default:l(()=>[fe,be]),_:1}),a(t,{to:"#",class:"sub-menu--option options-bottom"},{default:l(()=>[he,ge]),_:1}),a(t,{to:"#",class:"sub-menu--option options-bottom"},{default:l(()=>[ye,Ve]),_:1})]),_:1})):v("",!0)])])):v("",!0)]),_:1})}}};export{Me as default};
