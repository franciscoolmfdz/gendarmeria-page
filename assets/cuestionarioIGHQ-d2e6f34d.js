import{u as q,g as n,r as w,o as D,f as V,j as G,_ as E,m as v,n as N,b as r,a as R,l as T}from"./index-268772aa.js";import{_ as B}from"./subSideNav-11a5ce54.js";import{_ as L}from"./CHeaderBar-873738c0.js";import{_ as O}from"./CFilterbar-bf69c50e.js";import{_ as X}from"./CCard-23aa0275.js";import{_ as Y}from"./CColunmChart-fc62ac14.js";import"./CChartDonutSection-d5669898.js";import"./CButton-9395e1c7.js";const z={class:"chart-section-principal"},M={class:"cuestionario-ghq-funcionario"},W={class:"chart-section"},j=r("span",{class:"card-title"},"Escala de evaluación",-1),J=r("span",{class:"question--value"},"Ausencia de psicopatología: De 0 a 2 puntos.",-1),K=r("span",{class:"question--value"},"Sospecha de psicopatología: 3 a 6 puntos.",-1),U=r("span",{class:"question--value"},"Indicativo de presencia de psicopatología: 7 ó mas puntos.",-1),y=2,ce={__name:"cuestionarioIGHQ",setup(Z){const s=q(),l=n(!1),b=n("Calidad de vida de los funcionarios / Cuestionario de Salud GHQ-12 de Goldberg"),f=n([]),x=n(0),A=n({categories:["Ausencia","Sospecha","Presencia","No asignado"],crosshair:!1}),C=n({min:0,allowDecimals:!1,title:{text:""}}),H=n({column:{pointPadding:.2,borderWidth:3}}),P=n({headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),u=w([]),$=(e,o,t)=>w({id:e,name:o,data:t,dataLabels:{enabled:!0,color:"#fff",align:"center",x:-15,style:{inside:!0,fontSize:"10px",fontFamily:"helvetica, arial, sans-serif",textShadow:!1,fontWeight:"normal"}}}),F=async e=>{l.value=!0;const o=u.filter(t=>t.id!==e);f.value=f.value.filter(t=>t.carcelId!=e),S(),u.splice(0,u.length),o.map(t=>u.push(t)),await s.sleep(50),l.value=!1},S=()=>{let e=f.value.reduce((o,t)=>o+t.pointValue,0);e=e/f.value.length,e=_(e),x.value=e.toString()},Q=e=>{let o=e[0].recordId,t=0,d=0,p=0,a=0,c=0;for(let m=0;m<e.length;m++){let i=e[m];i.recordId==o&&i.pound>=0?(a+=i.pound,c+=i.value):(a<2?t++:a>2&&a<=6?d++:a>6&&p++,a=i.pound,o=i.recordId)}let h=e.length/12;c=c/h/6+1.2;const g=t+d+p;return[_(t/g*100),_(d/g*100),_(p/g*100),c]},_=e=>e?Math.round(e*100)/100:0,I=async(e,o,t)=>{var d,p;try{let a=((d=s==null?void 0:s.penitenciaria)==null?void 0:d.id)??null,c=((p=s==null?void 0:s.penitenciaria)==null?void 0:p.description)??null,h=s.historyId;if(t&&(a=e,c=o),h&&a){l.value=!0;let m=await T({historyId:h,carcelId:a,categoryId:2,subCategoryId:22,embedDetail:!0});const i=Q(m.items);f.value.push({carcelId:a,pointValue:_(i[3])}),S(),u.push($(a,c,i.slice(0,-1)))}}catch(a){console.log(a)}finally{t||(l.value=!1)}},k=async()=>{l.value=!0,s.carcelesSelected&&s.carcelesSelected.length>0&&await Promise.all(s.carcelesSelected.map(async e=>await I(e.id,e.description,!0))),l.value=!1};return(e,o)=>(D(),V(E,null,{default:G(()=>[v(L,{title:b.value,"section-value":y},null,8,["title"]),v(N,{"active-spin":l.value},null,8,["active-spin"]),v(O,{baseFilter:y,multipleDisabled:!1,onExecuteMount:k,onExecuteAction:I,onExecuteRemove:F}),r("div",z,[v(B,{class:"subsection-funcionarios",title:b.value,"section-value":y,pointValue:x.value,pointTitle:"Cuestionario General de Salud GHQ-12 de Goldberg",pointSubtitle:"Promedio respuestas cuestionario General de Salud GHQ-12 de Goldberg"},null,8,["title","pointValue"]),r("div",M,[r("div",W,[l.value?R("",!0):(D(),V(Y,{key:0,chartType:"bar",optionsAxisX:A.value,optionsAxisY:C.value,plotOptions:H.value,tooltip:P.value,series:u},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))]),v(X,{class:"card-preguntas"},{default:G(()=>[j,J,K,U]),_:1})])])]),_:1}))}};export{ce as default};
