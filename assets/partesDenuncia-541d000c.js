import{u as k,g as s,h as x,o as f,f as R,j as B,_ as L,q as N,l as I,b as u,m as n,n as J,x as T,a as C,c as O,e as z,C as H}from"./index-b5adf2c2.js";import{_ as j}from"./CHeaderBar-c5f14508.js";import{_ as q}from"./subSideNav-5516e76e.js";import{_ as S}from"./CButton-105090c3.js";import{_ as U}from"./CTable-33e92bde.js";import{s as G}from"./filterSituacion-41060dba.js";import"./CChartDonutSection-dbb0a378.js";const K={class:"content-header-partes"},Q={class:"selected-options"},W={key:0,class:"c-option-volver"},X={class:"table-section-principal"},Y={class:"content__section"},d=3,h=32,re={__name:"partesDenuncia",setup(Z){const o=G(),m=k(),r=s(!1),i=s({id:15,description:"Región Metropolitana de Santiago"}),p=s([]),v=s(0),l=s(null),c=s(null),_=s(""),g=s("Estado situación carcelaria / Resumen partes ley 20.000"),V=s([{description:"Centro penitenciario",colspan:1},{description:_,colspan:12},{description:"Resumen",colspan:3}]),D=s([{rowReference:"establecimiento",description:"Establecimiento"},{rowReference:"dataEnero",description:"Enero"},{rowReference:"dataFebrero",description:"Feb"},{rowReference:"dataMarzo",description:"Marzo"},{rowReference:"dataAbril",description:"Abril"},{rowReference:"dataMayo",description:"Mayo"},{rowReference:"dataJunio",description:"Junio"},{rowReference:"dataJulio",description:"Julio"},{rowReference:"dataAgosto",description:"Agosto"},{rowReference:"dataSeptiembre",description:"Septiembre"},{rowReference:"dataOctubre",description:"Octubre"},{rowReference:"dataNoviembre",description:"Nombiembre"},{rowReference:"dataDiciembre",description:"Diciembre"},{rowReference:"otros",description:"Otros"},{rowReference:"leyVeinteMil",description:"Ley 20.000"},{rowReference:"total",description:"Total"}]),w=s([]),$=()=>{z.push("/situacionCarcelaria")},M=async()=>{o.changeRegionSelected(i.value),await b(),await y()},A=async e=>{if(!o.listadoRegiones.length>0){let a={regionId:null};l.value&&(a.regionId=l.value);let t=await N(a);p.value=t,o.setRegionesList(t)}else p.value=o.listadoRegiones},b=async()=>{let e=await H();o.setCarcelesList(e)},E=async()=>{var a,t;let e={categoryId:d,historySubCategoryId:h,lastPeriod:!0};return v.value||(v.value=await I(e)),e={categoryId:d,historySubCategoryId:h,historyId:v.value.id,embedLawParts:!0},i.value?e.regionId=(a=i.value)!=null&&a.id?i.value.id:i.value:(t=o==null?void 0:o.regionSelected)!=null&&t.id&&(e.regionId=o.regionSelected.id),c.value&&(e.carcelId=c.value),await b(),e},y=async()=>{try{const e=await E(),a=await I(e);_.value=`Año ${a.period}`,w.value=a.items.map(t=>{const F=o.listadoCarceles.find(P=>P.id==t.carcelId);return t.establecimiento=F.description,t.otros=t.total-t.leyVeinteMil,t})}catch(e){console.log(e)}};return x(async()=>{r.value=!0,i.value=o.regionSelected;const e=m.user.restrictions.find(t=>t.typeId===2),a=m.user.restrictions.find(t=>t.typeId===3);e?l.value=parseInt(e.restriction):a?c.value=parseInt(a.restriction):(c.value=null,l.value=null),i.value=o.regionSelected.value,await A(),await y(),r.value=!1}),(e,a)=>(f(),R(L,{class:"contenido-partes"},{default:B(()=>[u("div",K,[n(j,{title:g.value,"section-value":d},null,8,["title"]),n(J,{"active-spin":r.value},null,8,["active-spin"]),u("div",Q,[r.value?C("",!0):(f(),R(T,{key:0,class:"select-region",options:p.value,modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=t=>i.value=t)},null,8,["options","modelValue"])),n(S,{class:"btn-search",title:"",onExecuteAction:a[1]||(a[1]=t=>M())})]),!r.value&&e.topPosition!==0?(f(),O("div",W,[n(S,{class:"btn-volver",title:"Volver",onExecuteAction:$,disabled:e.blockButton},null,8,["disabled"])])):C("",!0)]),u("div",X,[n(q,{class:"subsection-partes",title:g.value,"section-value":d,pointValue:e.pointCalculated,pointTitle:"Partes denuncia ley 20.000",pointSubtitle:""},null,8,["title","pointValue"]),u("div",Y,[n(U,{"parent-columns":V.value,columns:D.value,rows:w.value},null,8,["parent-columns","columns","rows"])])])]),_:1}))}};export{re as default};
