import{g as o,u as N,r as x,o as I,f as S,j as R,_ as T,m as r,n as B,b as F,a as L,k as O}from"./index-4db8e7f1.js";import{_ as X}from"./subSideNav-ecbc9dc1.js";import{_ as Y}from"./CHeaderBar-c13a152f.js";import{_ as j}from"./CFilterbar-029756cf.js";import{_ as z}from"./CColunmChart-5a632953.js";import"./CChartDonutSection-e923d460.js";import"./CButton-82bc19c5.js";const G={class:"principal-section principal-section-reincidencia"},H={class:"chart-section"},p=4,te={__name:"reincidencia",setup(W){const u=o(0),e=N(),i=o(!1),f=o("Elementos de reinserción / Internos reincidentes en cada recinto"),w=o({categories:["Sí","No"]}),D=o({min:0,allowDecimals:!1,title:{text:"Porcentaje de internos con IGI aplicado"}}),V=o({column:{pointPadding:.2,borderWidth:3}}),$=o({headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}%</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),s=x([]),k=(t,l,a)=>x({id:t,name:l,data:a,dataLabels:{enabled:!0,color:"#fff",align:"right",y:10,pointFormat:'<tr><td style="padding:0"><b>{point.y}%</b></td></tr>',style:{inside:!1,fontSize:"10px",fontFamily:"helvetica, arial, sans-serif",textShadow:!1,fontWeight:"normal"}}}),A=async t=>{i.value=!0;const l=s.filter(a=>a.id!==t);s.splice(0,s.length),l.map(a=>s.push(a)),await e.sleep(50),i.value=!1},m=async(t,l,a)=>{var _,v;try{let c=((_=e==null?void 0:e.penitenciaria)==null?void 0:_.id)??null,y=((v=e==null?void 0:e.penitenciaria)==null?void 0:v.description)??null,h=e.historyId;if(a&&(c=t,y=l),h&&c){i.value=!0;let C=await O({historyId:h,carcelId:c,categoryId:p,subCategoryId:24});const n=[];C.map(d=>{n.push(d.pound)});let b=[n[0]+n[2]];const g=n.reduce((d,E)=>d+E,0);b=[parseFloat(((n[0]+n[2])/g*100).toFixed(1))],u.value=((n[0]+n[2])/g*100).toFixed(1),s.push(k(c,y,b))}}catch(c){console.log(c)}finally{a||(i.value=!1)}},P=async()=>{i.value=!0,e.carcelesSelected&&e.carcelesSelected.length>0&&await Promise.all(e.carcelesSelected.map(async t=>await m(t.id,t.description,!0))),i.value=!1};return(t,l)=>(I(),S(T,{class:"contenedor-reincidencia"},{default:R(()=>[r(Y,{title:f.value,"section-value":p},null,8,["title"]),r(B,{"active-spin":i.value},null,8,["active-spin"]),r(j,{baseFilter:p,monthDisabled:!0,multipleDisabled:!1,onExecuteMount:P,onExecuteAction:m,onExecuteRemove:A}),F("div",G,[r(X,{class:"subsection-funcionarios",title:f.value,"section-value":p,pointValue:u.value,pointTitle:"Internos reincidentes en cada recinto",pointSubtitle:"Proporción (%) Internos reincidentes en cada recinto","point-is-percent":!0,"point-type":2},null,8,["title","pointValue","pointSubtitle"]),F("div",H,[i.value?L("",!0):(I(),S(z,{key:0,chartType:"bar",optionsAxisX:w.value,optionsAxisY:D.value,plotOptions:V.value,tooltip:$.value,series:s},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))])])]),_:1}))}};export{te as default};
