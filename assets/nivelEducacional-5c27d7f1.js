import{u as G,g as r,r as q,o as A,f as P,j as T,_ as J,m as v,n as K,b as h,a as Q,l as U}from"./index-6cde2442.js";import{_ as Z}from"./CHeaderBar-2d6d0b63.js";import{_ as E}from"./CFilterbar-5d2801c4.js";import{_ as ee}from"./subSideNav-9827078f.js";import{_ as te}from"./CCard-126910ad.js";import{_ as ae}from"./CColunmChart-4b73e99b.js";import"./CButton-7e8ab65d.js";import"./CChartDonutSection-d0252771.js";const oe={class:"chart-section-principal"},le={class:"section-nivel-educ"},se={class:"chart-section"},ie=h("span",{class:"card-title"},"Pregunta",-1),ne=h("span",{class:"question--value"},"3. ¿Hasta qué curso llegó (en la calle)?",-1),y=7,_e={__name:"nivelEducacional",setup(re){const l=G(),n=r(!1),M=r("Trayectoria / ¿Hasta qué curso llegó (en la calle)?"),I=r(""),u=r([]),H=r({categories:["sin estudios formales","primero básico","segundo básico","tercero básico","cuarto básico","quinto básico","sexto básico","séptimo básico","octavo básico","I medio","II medio","III medio","IV medio completo","superior incompleta","superior completa","no asignado"],crosshair:!1}),k=r({min:0,allowDecimals:!1,title:{text:"Suma por categoría"}}),L=r({column:{pointPadding:.2,borderWidth:3}}),N=r({headerFormat:'<span style="font-size:10px">{point.key}%</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}%</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),O=e=>e?Math.round(e*100)/100:0,c=q([]),X=(e,s,o)=>q({id:e,name:s,data:o,dataLabels:{enabled:!0,color:"#fff",align:"center",x:-15,pointFormat:'<tr><td style="padding:0"><b>{point.y}%</b></td></tr>',style:{inside:!0,fontSize:"10px",fontFamily:"helvetica, arial, sans-serif",textShadow:!1,fontWeight:"normal"}}}),S=()=>{let e=u.value.reduce((s,o)=>s+o.pointCarcel,0);e=e/u.value.length,e=Math.round(O(e)),I.value=e.toString()},Y=async e=>{n.value=!0;const s=c.filter(o=>o.id!==e);c.splice(0,c.length),u.value=u.value.filter(o=>o.carcelId!==e),S(),s.map(o=>c.push(o)),await l.sleep(50),n.value=!1},z=(e,s)=>{let o=0,p=0,m=0,i=0,d=0,f=0,b=0,_=0,g=0,C=0,D=0,w=0,V=0,F=0,$=0,j=null,R=0,a=0;for(let t=0;t<e.length;t++)e[t].value===-1?j+=e[t].value*-1:(R+=e[t].value,a++),e[t].value===0&&o++,e[t].value===1&&p++,e[t].value===2&&m++,e[t].value===3&&i++,e[t].value===4&&d++,e[t].value===5&&f++,e[t].value===6&&b++,e[t].value===7&&_++,e[t].value===8&&g++,e[t].value===9&&C++,e[t].value===10&&D++,e[t].value===11&&w++,e[t].value===12&&V++,e[t].value===13&&F++,e[t].value===14&&$++;const x=[Math.round(o*100/a),Math.round(p*100/a),Math.round(m*100/a),Math.round(i*100/a),Math.round(d*100/a),Math.round(f*100/a),Math.round(b*100/a),Math.round(_*100/a),Math.round(g*100/a),Math.round(C*100/a),Math.round(D*100/a),Math.round(w*100/a),Math.round(V*100/a),Math.round(F*100/a),Math.round($*90/a)];return console.log(Math.max(...x)),u.value.push({carcelId:s,pointCarcel:Math.max(...x)}),S(),x},B=async(e,s,o)=>{var p,m;try{let i=((p=l==null?void 0:l.penitenciaria)==null?void 0:p.id)??null,d=((m=l==null?void 0:l.penitenciaria)==null?void 0:m.description)??null,f=l.historyId;if(o&&(i=e,d=s),f&&i){n.value=!0;let _=await U({historyId:f,carcelId:i,categoryId:y,subCategoryId:23,embedDetail:!0,dimensionId:126});const g=z(_.items,i);c.push(X(i,d,g))}}catch(i){console.log(i)}finally{o||(n.value=!1)}},W=async()=>{n.value=!0,l.carcelesSelected&&l.carcelesSelected.length>0&&await Promise.all(l.carcelesSelected.map(async e=>await B(e.id,e.description,!0))),n.value=!1};return(e,s)=>(A(),P(J,null,{default:T(()=>[v(Z,{title:M.value,"section-value":y},null,8,["title"]),v(K,{"active-spin":n.value},null,8,["active-spin"]),v(E,{baseFilter:y,multipleDisabled:!1,onExecuteMount:W,onExecuteAction:B,onExecuteRemove:Y}),h("div",oe,[v(ee,{class:"ection-nivel-educacional",title:M.value,"section-value":y,pointValue:I.value,pointTitle:"3. ¿Hasta qué curso llegó (en la calle)?",pointSubtitle:"",type:2},null,8,["title","pointValue","pointTitle"]),h("div",le,[h("div",se,[n.value?Q("",!0):(A(),P(ae,{key:0,chartType:"bar",optionsAxisX:H.value,optionsAxisY:k.value,plotOptions:L.value,tooltip:N.value,series:c},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))]),v(te,{class:"card-preguntas"},{default:T(()=>[ie,ne]),_:1})])])]),_:1}))}};export{_e as default};
