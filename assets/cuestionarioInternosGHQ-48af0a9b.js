import{u as k,g as l,r as I,o as w,f as G,j as R,_ as T,m,n as B,b as _,a as E,l as L}from"./index-d5d29b93.js";import{_ as N}from"./subSideNav-7690126a.js";import{_ as O}from"./CHeaderBar-c99abf49.js";import{_ as X}from"./CFilterbar-6fdaab9f.js";import{_ as Y}from"./CColunmChart-9503d52d.js";import"./CChartDonutSection-be9d7933.js";import"./CCard-fa753b4a.js";import"./CButton-1f0b74cb.js";const z={class:"chart-section-principal"},M={class:"cuestionario-ghq"},W={class:"chart-section"},v=1,oe={__name:"cuestionarioInternosGHQ",setup(j){const o=k(),i=l(!1),h=l("Calidad de vida de los internos / Cuestionario de Salud GHQ-12 de Goldberg"),d=l([]),g=l(0),V=l({categories:["Ausencia","Sospecha","Presencia"],crosshair:!1}),D=l({min:0,allowDecimals:!1,title:{text:""}}),A=l({column:{pointPadding:.2,borderWidth:3}}),C=l({headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),c=I([]),H=(e,s,t)=>I({id:e,name:s,data:t,dataLabels:{enabled:!0,color:"#fff",align:"center",x:-10,style:{inside:!0,fontSize:"10px",fontFamily:"helvetica, arial, sans-serif",textShadow:!1,fontWeight:"normal"}}}),P=async e=>{i.value=!0;const s=c.filter(t=>t.id!==e);d.value=d.value.filter(t=>t.carcelId!=e),b(),c.splice(0,c.length),s.map(t=>c.push(t)),await o.sleep(50),i.value=!1},y=e=>e?Math.round(e*100)/100:0,b=()=>{let e=d.value.reduce((s,t)=>s+t.pointValue,0);e=e/d.value.length,e=y(e),g.value=e.toString()},F=e=>{let s=e[0].recordId,t=0,p=0,f=0,a=0,n=0;for(let u=0;u<e.length;u++){let r=e[u];r.recordId==s&&r.pound>=0?(a+=r.pound,n+=r.value):(a<2?t++:a>2&&a<=6?p++:a>6&&f++,a=r.pound,s=r.recordId)}return n=n/e.length+1.3,[t,p,f,n]},x=async(e,s,t)=>{var p,f;try{let a=((p=o==null?void 0:o.penitenciaria)==null?void 0:p.id)??null,n=((f=o==null?void 0:o.penitenciaria)==null?void 0:f.description)??null,u=o.historyId;if(t&&(a=e,n=s),u&&a){i.value=!0;let $=await L({historyId:u,carcelId:a,categoryId:1,subCategoryId:21,embedDetail:!0});const S=F($.items);d.value.push({carcelId:a,pointValue:y(S[3])}),b(),c.push(H(a,n,S.slice(0,-1)))}}catch(a){console.log(a)}finally{t||(i.value=!1)}},Q=async()=>{i.value=!0,o.carcelesSelected&&o.carcelesSelected.length>0&&await Promise.all(o.carcelesSelected.map(async e=>await x(e.id,e.description,!0))),i.value=!1};return(e,s)=>(w(),G(T,null,{default:R(()=>[m(O,{title:h.value,"section-value":v},null,8,["title"]),m(B,{"active-spin":i.value},null,8,["active-spin"]),m(X,{baseFilter:v,multipleDisabled:!1,onExecuteMount:Q,onExecuteAction:x,onExecuteRemove:P}),_("div",z,[m(N,{title:h.value,"section-value":v,pointValue:g.value,pointTitle:"Cuestionario General de Salud GHQ-12 de Goldberg",pointSubtitle:"Promedio respuestas cuestionario General de Salud GHQ-12 de Goldberg"},null,8,["title","pointValue"]),_("div",M,[_("div",W,[i.value?E("",!0):(w(),G(Y,{key:0,chartType:"bar",optionsAxisX:V.value,optionsAxisY:D.value,plotOptions:A.value,tooltip:C.value,series:c},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))])])])]),_:1}))}};export{oe as default};
