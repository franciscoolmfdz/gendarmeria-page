import{u as R,g as r,r as A,o as F,f as P,j as T,_ as G,m as v,n as J,b as _,a as K,l as Q}from"./index-d5d29b93.js";import{_ as U}from"./CHeaderBar-c99abf49.js";import{_ as Z}from"./CFilterbar-6fdaab9f.js";import{_ as E}from"./subSideNav-7690126a.js";import{_ as ee}from"./CCard-fa753b4a.js";import{_ as te}from"./CColunmChart-9503d52d.js";import"./CButton-1f0b74cb.js";import"./CChartDonutSection-be9d7933.js";const ae={class:"chart-section-principal"},oe={class:"section-nivel-educ"},le={class:"chart-section"},se=_("span",{class:"card-title"},"Pregunta",-1),ie=_("span",{class:"question--value"},"3. ¿Hasta qué curso llegó (en la calle)?",-1),y=7,_e={__name:"nivelEducacional",setup(ne){const l=R(),n=r(!1),x=r("Trayectoria / ¿Hasta qué curso llegó (en la calle)?"),M=r(""),u=r([]),H=r({categories:["sin estudios formales","primero básico","segundo básico","tercero básico","cuarto básico","quinto básico","sexto básico","séptimo básico","octavo básico","I medio","II medio","III medio","IV medio completo","superior incompleta","superior completa","no asignado"],crosshair:!1}),k=r({min:0,allowDecimals:!1,title:{text:"Suma por categoría"}}),L=r({column:{pointPadding:.2,borderWidth:3}}),N=r({headerFormat:'<span style="font-size:10px">{point.key}%</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}%</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),O=e=>e?Math.round(e*100)/100:0,c=A([]),X=(e,s,o)=>A({id:e,name:s,data:o,dataLabels:{enabled:!0,color:"#fff",align:"center",x:-15,style:{inside:!0,fontSize:"10px",fontFamily:"helvetica, arial, sans-serif",textShadow:!1,fontWeight:"normal"}}}),I=()=>{let e=u.value.reduce((s,o)=>s+o.pointCarcel,0);e=e/u.value.length,e=O(e),M.value=e.toString()},Y=async e=>{n.value=!0;const s=c.filter(o=>o.id!==e);c.splice(0,c.length),u.value=u.value.filter(o=>o.carcelId!==e),I(),s.map(o=>c.push(o)),await l.sleep(50),n.value=!1},z=(e,s)=>{let o=0,p=0,f=0,i=0,m=0,d=0,b=0,h=0,g=0,B=0,C=0,D=0,w=0,V=0,$=0,j=null,q=0,a=0;for(let t=0;t<e.length;t++)e[t].value===-1?j+=e[t].value*-1:(q+=e[t].value,a++),e[t].value===0&&o++,e[t].value===1&&p++,e[t].value===2&&f++,e[t].value===3&&i++,e[t].value===4&&m++,e[t].value===5&&d++,e[t].value===6&&b++,e[t].value===7&&h++,e[t].value===8&&g++,e[t].value===9&&B++,e[t].value===10&&C++,e[t].value===11&&D++,e[t].value===12&&w++,e[t].value===13&&V++,e[t].value===14&&$++;return u.value.push({carcelId:s,pointCarcel:Math.round(q/a)}),I(),[Math.round(o*100/a),Math.round(p*100/a),Math.round(f*100/a),Math.round(i*100/a),Math.round(m*100/a),Math.round(d*100/a),Math.round(b*100/a),Math.round(h*100/a),Math.round(g*100/a),Math.round(B*100/a),Math.round(C*100/a),Math.round(D*100/a),Math.round(w*100/a),Math.round(V*100/a),Math.round($*90/a)]},S=async(e,s,o)=>{var p,f;try{let i=((p=l==null?void 0:l.penitenciaria)==null?void 0:p.id)??null,m=((f=l==null?void 0:l.penitenciaria)==null?void 0:f.description)??null,d=l.historyId;if(o&&(i=e,m=s),d&&i){n.value=!0;let h=await Q({historyId:d,carcelId:i,categoryId:y,subCategoryId:23,embedDetail:!0,dimensionId:126});const g=z(h.items,i);c.push(X(i,m,g))}}catch(i){console.log(i)}finally{o||(n.value=!1)}},W=async()=>{n.value=!0,l.carcelesSelected&&l.carcelesSelected.length>0&&await Promise.all(l.carcelesSelected.map(async e=>await S(e.id,e.description,!0))),n.value=!1};return(e,s)=>(F(),P(G,null,{default:T(()=>[v(U,{title:x.value,"section-value":y},null,8,["title"]),v(J,{"active-spin":n.value},null,8,["active-spin"]),v(Z,{baseFilter:y,multipleDisabled:!1,onExecuteMount:W,onExecuteAction:S,onExecuteRemove:Y}),_("div",ae,[v(E,{class:"ection-nivel-educacional",title:x.value,"section-value":y,pointValue:M.value,pointTitle:"3. ¿Hasta qué curso llegó (en la calle)?",pointSubtitle:"",type:2},null,8,["title","pointValue","pointTitle"]),_("div",oe,[_("div",le,[n.value?K("",!0):(F(),P(te,{key:0,chartType:"bar",optionsAxisX:H.value,optionsAxisY:k.value,plotOptions:L.value,tooltip:N.value,series:c},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))]),v(ee,{class:"card-preguntas"},{default:T(()=>[se,ie]),_:1})])])]),_:1}))}};export{_e as default};
