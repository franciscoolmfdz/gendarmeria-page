import{s as S,g as c,h as U,i as V,o as G,f as x,j as m,_ as k,x as F,y as M,l as B,m as p,n as H,b as s,k as w}from"./index-361d98cb.js";import{_ as P,a as N}from"./CChartDonutSection-360ccab3.js";import{_ as j}from"./CHeaderBar-41292442.js";import{_ as q}from"./CTable-0cf4a6a2.js";import{s as z}from"./filterSituacion-8fa6cf96.js";const T="/dmm/dimension-history-program",K=async(o,r)=>{if(o!=null&&o.id){let I=`${T}/${o.id}`;return S(I,"GET",null,r)}let i=T,a=null;return o!=null&&o.regionId&&(a?a=`${a}&regionId=${o.regionId}`:a=`regionId=${o.regionId}`),o!=null&&o.carcelId&&(a?a=`${a}&carcelId=${o.carcelId}`:a=`carcelId=${o.carcelId}`),o!=null&&o.historyId&&(a?a=`${a}&historyId=${o.historyId}`:a=`historyId=${o.historyId}`),a&&(i=`${i}?${a}`),S(i,"GET",null,r)};const O={class:"information-section-program"},Q=s("span",{class:"sub-menu__option--title"}," Ver más ",-1),W=s("span",{class:"sub-menu__option--title"}," Ver más ",-1),X={class:"information__section"},Y=s("span",{class:"card-title"},"Programas",-1),Z=s("div",{class:"card-subsection"},[s("span",{class:"card-subtitle"},"PPL :"),s("span",null," Programa de reinserción social para personas privadas de libertad")],-1),ee=s("div",{class:"card-subsection"},[s("span",{class:"card-subtitle"},"PRS :"),s("span",null," Programa Ministerio del Interior")],-1),se=s("div",{class:"card-subsection"},[s("span",{class:"card-subtitle"},"CET C :"),s("span",null," CET Cerrado")],-1),oe=s("div",{class:"card-subsection"},[s("span",{class:"card-subtitle"},"CET S :"),s("span",null," CET Semiabierto")],-1),ae=s("div",{class:"card-subsection"},[s("span",{class:"card-subtitle"},"CTA :"),s("span",null," Centro de tratamiento de adicciones")],-1),te=s("div",{class:"card-subsection"},[s("span",{class:"card-subtitle"},"SSJJ :"),s("span",null," Secciones Juveniles")],-1),ne=s("div",{class:"card-subsection"},[s("span",{class:"card-subtitle"},"CJ :"),s("span",null," Creciendo Juntos")],-1),re={class:"content__section table-program"},h=4,pe={__name:"ElementosReinsercion",setup(o){const r=z(),i=c(!1),a=c([]),I=c([]);c(null);const E=c("Elementos de reinserción"),y=c(null),b=c(null),$=c([{rowReference:"region",description:"Región",class:"region"},{rowReference:"carcel",description:"Establecimiento penal"},{rowReference:"programPPL",description:"PPL"},{rowReference:"programPLS",description:"PRS"},{rowReference:"programCETC",description:"CET C"},{rowReference:"programCETSA",description:"CET SA"},{rowReference:"programCTA",description:"CTA"},{rowReference:"programSSJJ",description:"SSJJ"},{rowReference:"programCJ",description:"CJ"},{rowReference:"total",description:"Total en funcionamiento"}]),R=c([]),J=async v=>{if(!r.listadoRegiones.value||r.listadoRegiones.length>0){let l=await F();a.value=l,r.setRegionesList(l)}else a.value=r.listadoRegiones;if(!r.listadoCarceles.value||r.listadoCarceles.length>0){let l=await M();I.value=l,r.setRegionesList(l)}else I.value=r.listadoCarceles},L=async(v,l,d)=>{try{i.value=!0;let e=await w({historyId:8,categoryId:h,subCategoryId:24});const n=[0,0,0,0];e.map(t=>{t.valueUsed===1&&(n[0]+=t.pound),t.valueUsed===2&&(n[1]+=t.pound),t.valueUsed===3&&(n[2]+=t.pound),t.valueUsed===4&&(n[3]+=t.pound)});let _=n[0]+n[2];const u=n.reduce((t,C)=>t+C,0);y.value=parseFloat((_/u*100).toFixed(1))??0}catch(g){console.log(g)}finally{d||(i.value=!1)}},D=async(v,l,d)=>{try{let e=await w({historyId:8,categoryId:h,subCategoryId:25}),n=0,_=0,u=0;e.map(f=>{f.valueUsed===1?n+=f.pound:f.valueUsed===3?_+=f.pound:(f.valueUsed===2||f.valueUsed===4)&&(u+=f.pound)});const t=n+_,C=t+u;b.value=parseFloat((t/C*100).toFixed(1))}catch(g){console.log(g)}finally{d||(i.value=!1)}},A=async()=>{try{i.value=!0;const d={historyId:(await B({categoryId:4,historySubCategoryId:26,lastPeriod:!0})).id},g=await K(d);R.value=g.map(e=>{const n=a.value.find(u=>u.id===e.regionId);e.region={data:n.shortDescription,class:"region"},console.log(e.centroId);const _=I.value.find(u=>u.id===e.centroId);return console.log(_),e.carcel=_.description,e.programPPL=e.programPPL?{data:".",class:"data-circle"}:"",e.programPLS=e.programPLS?{data:".",class:"data-circle"}:"",e.programCETC=e.programCETC?{data:".",class:"data-circle"}:"",e.programCETSA=e.programCETSA?{data:".",class:"data-circle"}:"",e.programCTA=e.programCTA?{data:".",class:"data-circle"}:"",e.programSSJJ=e.programSSJJ?{data:".",class:"data-circle"}:"",e.programCJ=e.programCJ?{data:".",class:"data-circle"}:"",e.total={data:e.total,class:"value-total"},e.promedio={data:e.promedio,class:"value-total"},e}),await L(),await D(),i.value=!1}catch(v){console.log(v)}};return U(async()=>{await J(),await A()}),(v,l)=>{const d=V("RouterLink");return G(),x(k,{class:"contenedor-reinsercion"},{default:m(()=>[p(j,{title:E.value,"section-value":h},null,8,["title"]),p(H,{"active-spin":i.value},null,8,["active-spin"]),s("div",O,[p(P,{class:"section-donut",title:"Reinserción IGI","point-value":y.value,type:2,"is-percent":!0},{default:m(()=>[p(d,{to:"situacionReincidencia",class:"sub-menu--option white btn-small"},{default:m(()=>[Q]),_:1})]),_:1},8,["point-value"]),p(P,{class:"section-donut",title:"Internos con IGI","point-value":b.value,type:2,"is-percent":!0},{default:m(()=>[p(d,{to:"regimenProcesal",class:"sub-menu--option white btn-small"},{default:m(()=>[W]),_:1})]),_:1},8,["point-value"]),s("div",X,[p(N,{class:"card-information card-program"},{default:m(()=>[Y,Z,ee,se,oe,ae,te,ne]),_:1})])]),s("div",re,[p(q,{columns:$.value,rows:R.value},null,8,["columns","rows"])])]),_:1})}}};export{pe as default};
