import{_ as T}from"./CButton-d9f18b09.js";import{g as p,u as E,h as M,i as N,o as m,f as I,j as s,_ as L,k as j,l as x,m as o,c as g,a as b,n as U,b as n}from"./index-01c65d82.js";import{_ as r}from"./CChartDonutSection-6e97f3a7.js";import{_ as q}from"./CHeaderBar-27cb1ce3.js";import{_ as D}from"./CCard-c0ac7723.js";const z={key:0,class:"c-option-volver"},J={key:1,class:"principal-section section-internos"},K={class:"principal-section"},O={key:0,class:"principal-section__top top-position-one"},W=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),X=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),Y=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),Z=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),tt=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),et={key:1,class:"principal-section__top top-position-two"},st=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),ot=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),nt=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),at=n("span",{class:"sub-menu__option--title"}," Ver más ",-1),lt={class:"principal-section__bottom"},it=n("span",{class:"sub-menu__option--title"},"Información personal",-1),ut=n("span",{class:"sub-menu__option--text"}," Consulta sobre información personal de internos ",-1),ct=n("span",{class:"sub-menu__option--title"},"Régimen carcelario",-1),rt=n("span",{class:"sub-menu__option--text"},"Consulta sobre el régimen carcelario",-1),_t=n("span",{class:"sub-menu__option--title"},"Funcionamiento de la carcel",-1),dt=n("span",{class:"sub-menu__option--text"}," Consulta sobre funcionamiento de la carcel",-1),pt=n("span",{class:"sub-menu__option--title"},"Evaluación general",-1),mt=n("span",{class:"sub-menu__option--text"}," Consulta de evaluación general ",-1),bt=n("span",{class:"sub-menu__option--title"}," Infraestructura carcelaria",-1),vt=n("span",{class:"sub-menu__option--text"}," Consulta a los internos sobre la infraestructura carcelaria",-1),ft=n("span",{class:"sub-menu__option--title"},"Acceso a programas",-1),ht=n("span",{class:"sub-menu__option--text"}," Consulta a los internos sobre el acceso a programas de los internos",-1),gt=n("span",{class:"sub-menu__option--title"},"Trato con funcionarios",-1),Ct=n("span",{class:"sub-menu__option--text"},"Consulta a los internos sobre la relación con los funcionarios",-1),It=n("span",{class:"sub-menu__option--title"}," Cuestionario Salud GHQ-12 ",-1),yt=n("span",{class:"sub-menu__option--text"}," Consulta de resultados cuestionario de Salud GHQ-12 ",-1),wt=1,Rt={__name:"VidaInternos",setup(Vt){const H=p("Calidad de vida de los internos"),c=p(!1),y=E(),l=p([]),C=p(0),d=p(1),v=p(null),f=p(null),P=e=>e>0?Math.round(e*100)/100:0,R=()=>{d.value=0},w=async e=>{c.value=!0,d.value=e,c.value=!1},V=async()=>{let e={categoryId:1,lastPeriod:!0};return C.value||(C.value=await x(e)),e={categoryId:1,historyId:C.value.id},v.value&&(e.regionId=v.value),f.value&&(e.carcelId=f.value),e},$=async(e=2,a=8)=>{try{c.value=!0;const t=await V();let _=await j(t),i=null;for(let u=e;u<=a;u++){const A=u,k=_.filter(h=>h.subCategoryId===A&&h.valueUsed===1),Q=k.length;i=k.reduce((h,F)=>h+F.promPound,0),i=i/Q,i=P(i),l.value.push(i)}}catch(t){console.log(t)}},B=e=>{let a=e[0].recordId,t=0,_=0;for(let i=0;i<e.length;i++){let u=e[i];u.recordId==a&&u.pound>=0?(t+=u.pound,_+=u.value):(t=u.pound,a=u.recordId)}return _/e.length},G=e=>e?Math.round(e*100)/100:0,S=async()=>{try{let e=await V();c.value=!0;const a={...e,subCategoryId:21,embedDetail:!0};let t=await x(a);const _=B(t.items);l.value.push(G(_))}catch(e){console.log(e)}finally{c.value=!1}};return M(async()=>{c.value=!0;const e=y.user.restrictions.find(t=>t.typeId===2),a=y.user.restrictions.find(t=>t.typeId===3);e?v.value=parseInt(e.restriction):a?f.value=parseInt(a.restriction):(f.value=null,v.value=null),await $(),await S()}),(e,a)=>{const t=N("RouterLink");return m(),I(L,{class:"panel-vida-internos"},{default:s(()=>[o(q,{title:H.value,"section-value":wt},null,8,["title"]),!c.value&&d.value!==0?(m(),g("div",z,[o(T,{class:"btn-volver",title:"Volver",onExecuteAction:R,disabled:e.blockButton},null,8,["disabled"])])):b("",!0),o(U,{"active-spin":c.value},null,8,["active-spin"]),!c.value&&l.value.length>0?(m(),g("div",J,[n("div",K,[d.value==1?(m(),g("div",O,[o(r,{class:"section-donut",title:"Infraestructura carcelaria",subtitle:"Consulta a los internos sobre la infraestructura carcelaria","point-value":l.value[0]},{default:s(()=>[o(t,{to:"accesoProgramas",class:"sub-menu--option white btn-small"},{default:s(()=>[W]),_:1})]),_:1},8,["point-value"]),o(r,{class:"section-donut",title:"Acceso a programas",subtitle:"Consulta a los internos sobre el acceso a programas de los internos","point-value":l.value[1]},{default:s(()=>[o(t,{to:"accesoProgramas",class:"sub-menu--option white btn-small"},{default:s(()=>[X]),_:1})]),_:1},8,["point-value"]),o(r,{class:"section-donut",title:"Trato entre los internos",subtitle:"Consulta a los internos sobre la vida carcelaria","point-value":l.value[2]},{default:s(()=>[o(t,{to:"vidaInternosTrato",class:"sub-menu--option white btn-small"},{default:s(()=>[Y]),_:1})]),_:1},8,["point-value"]),o(r,{class:"section-donut",title:"Trato con funcionarios",subtitle:"Consulta a los internos sobre la relación con los funcionarios","point-value":l.value[3]},{default:s(()=>[o(t,{to:"vidaInternosFuncionario",class:"sub-menu--option white btn-small"},{default:s(()=>[Z]),_:1})]),_:1},8,["point-value"]),o(r,{class:"section-donut",title:"Cuestionario Salud GHQ-12",subtitle:"Consulta de resultados cuestionario de Salud GHQ-12",type:2,"point-value":l.value[7]},{default:s(()=>[o(t,{to:"cuestionarioGHQInterno",class:"sub-menu--option white btn-small"},{default:s(()=>[tt]),_:1})]),_:1},8,["point-value"])])):b("",!0),d.value==2?(m(),g("div",et,[o(r,{class:"section-donut",title:"Información personal",subtitle:"Consulta sobre información personal de internos","point-value":0},{default:s(()=>[o(t,{to:"vidaInternosPersonal",class:"sub-menu--option white btn-small"},{default:s(()=>[st]),_:1})]),_:1}),o(r,{class:"section-donut",title:"Régimen carcelario",subtitle:"Consulta sobre el régimen carcelario","point-value":l.value[4]},{default:s(()=>[o(t,{to:"regimenCarcel",class:"sub-menu--option white btn-small"},{default:s(()=>[ot]),_:1})]),_:1},8,["point-value"]),o(r,{class:"section-donut",title:"Funcionamiento de la carcel",subtitle:"Consulta sobre funcionamiento de la carcel","point-value":l.value[5]},{default:s(()=>[o(t,{to:"funcionamientoCarcel",class:"sub-menu--option white btn-small"},{default:s(()=>[nt]),_:1})]),_:1},8,["point-value"]),o(r,{class:"section-donut",title:"Evaluación general",subtitle:"Consulta de evaluación general","point-value":l.value[6]},{default:s(()=>[o(t,{to:"vidaInternosGeneral",class:"sub-menu--option white btn-small"},{default:s(()=>[at]),_:1})]),_:1},8,["point-value"])])):b("",!0)]),n("div",lt,[d.value!==2?(m(),I(D,{key:0,class:"card-information",onClick:a[0]||(a[0]=_=>w(2))},{default:s(()=>[o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[it,ut]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[ct,rt]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[_t,dt]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[pt,mt]),_:1})]),_:1})):b("",!0),d.value!==1?(m(),I(D,{key:1,class:"card-information",onClick:a[1]||(a[1]=_=>w(1))},{default:s(()=>[o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[bt,vt]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[ft,ht]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[gt,Ct]),_:1}),o(t,{to:"#",class:"sub-menu--option options-bottom"},{default:s(()=>[It,yt]),_:1})]),_:1})):b("",!0)])])):b("",!0)]),_:1})}}};export{Rt as default};
