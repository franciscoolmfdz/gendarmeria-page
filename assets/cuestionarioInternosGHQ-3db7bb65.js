import{u as E,g as n,r as I,o as w,f as G,j as N,_ as T,m as f,n as B,b as _,a as L,l as O}from"./index-68f8bedd.js";import{_ as X}from"./subSideNav-4b8b3248.js";import{_ as Y}from"./CHeaderBar-15eb3a90.js";import{_ as z}from"./CFilterbar-b73af337.js";import{_ as M}from"./CColunmChart-8bdfd6bf.js";import"./CChartDonutSection-1bb06b2b.js";import"./CCard-428d3126.js";import"./CButton-40472355.js";const W={class:"chart-section-principal"},j={class:"cuestionario-ghq"},q={class:"chart-section"},v=1,le={__name:"cuestionarioInternosGHQ",setup(J){const o=E(),i=n(!1),h=n("Calidad de vida de los internos / Cuestionario de Salud GHQ-12 de Goldberg"),u=n([]),g=n(0),V=n({categories:["Ausencia","Sospecha","Presencia","No asignado"],crosshair:!1}),D=n({min:0,allowDecimals:!1,title:{text:"Escala de frecuencia"}}),C=n({column:{pointPadding:.2,borderWidth:3}}),H=n({headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}</b>%</td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),r=I([]),P=(e,s,t)=>I({id:e,name:s,data:t,dataLabels:{enabled:!0,color:"#fff",align:"center",x:-10,style:{inside:!0,fontSize:"10px",fontFamily:"helvetica, arial, sans-serif",textShadow:!1,fontWeight:"normal"}}}),A=async e=>{i.value=!0;const s=r.filter(t=>t.id!==e);u.value=u.value.filter(t=>t.carcelId!=e),b(),r.splice(0,r.length),s.map(t=>r.push(t)),await o.sleep(50),i.value=!1},y=e=>e?Math.round(e*100)/100:0,b=()=>{let e=u.value.reduce((s,t)=>s+t.pointValue,0);e=e/u.value.length,e=y(e),g.value=e.toString()},F=e=>{let s=e[0].recordId,t=0,d=0,p=0,a=0;for(let c=0;c<e.length;c++){let l=e[c];l.recordId==s&&l.pound>=0?a+=l.pound:(a<2?t++:a>2&&a<=6?d++:a>6&&p++,a=l.pound,s=l.recordId)}return[t,d,p]},x=async(e,s,t)=>{var d,p;try{let a=((d=o==null?void 0:o.penitenciaria)==null?void 0:d.id)??null,c=((p=o==null?void 0:o.penitenciaria)==null?void 0:p.description)??null,l=o.historyId;if(t&&(a=e,c=s),l&&a){i.value=!0;let $=await O({historyId:l,carcelId:a,categoryId:1,subCategoryId:21,embedDetail:!0});const S=F($.items);let m=S.reduce((R,k)=>R+k);m=y(m/3),u.value.push({carcelId:a,pointValue:m}),b(),r.push(P(a,c,S))}}catch(a){console.log(a)}finally{t||(i.value=!1)}},Q=async()=>{i.value=!0,o.carcelesSelected&&o.carcelesSelected.length>0&&await Promise.all(o.carcelesSelected.map(async e=>await x(e.id,e.description,!0))),i.value=!1};return(e,s)=>(w(),G(T,null,{default:N(()=>[f(Y,{title:h.value,"section-value":v},null,8,["title"]),f(B,{"active-spin":i.value},null,8,["active-spin"]),f(z,{baseFilter:v,multipleDisabled:!1,onExecuteMount:Q,onExecuteAction:x,onExecuteRemove:A}),_("div",W,[f(X,{title:h.value,"section-value":v,pointValue:g.value,pointTitle:"Cuestionario General de Salud GHQ-12 de Goldberg",pointSubtitle:"Promedio respuestas cuestionario General de Salud GHQ-12 de Goldberg"},null,8,["title","pointValue"]),_("div",j,[_("div",q,[i.value?L("",!0):(w(),G(M,{key:0,chartType:"bar",optionsAxisX:V.value,optionsAxisY:D.value,plotOptions:C.value,tooltip:H.value,series:r},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))])])])]),_:1}))}};export{le as default};
