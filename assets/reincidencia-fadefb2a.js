import{g as o,u as N,r as b,o as x,f as S,j as P,_ as R,m as r,n as B,b as I,a as L,k as O}from"./index-71331f0e.js";import{_ as X}from"./subSideNav-79ca7b35.js";import{_ as Y}from"./CHeaderBar-b2149a61.js";import{_ as z}from"./CFilterbar-62f5bfce.js";import{_ as H}from"./CColunmChart-862f1b6e.js";import"./CChartDonutSection-8f8edfee.js";import"./CButton-9a1b4a0a.js";const W={class:"principal-section principal-section-reincidencia"},j={class:"chart-section"},p=4,te={__name:"reincidencia",setup(G){const d=o(0),e=N(),i=o(!1),f=o("Elementos de reinserción / Internos reincidentes en cada recinto"),w=o({categories:["Sí","No"]}),D=o({min:0,allowDecimals:!1,title:{text:"Total reincidencia por recinto"}}),F=o({column:{pointPadding:.2,borderWidth:3}}),V=o({headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),s=b([]),$=(t,l,n)=>b({id:t,name:l,data:n,dataLabels:{enabled:!0,color:"#fff",align:"right",y:-5,style:{inside:!1,fontSize:"10px",fontFamily:"helvetica, arial, sans-serif",textShadow:!1,fontWeight:"normal"}}}),k=async t=>{i.value=!0;const l=s.filter(n=>n.id!==t);s.splice(0,s.length),l.map(n=>s.push(n)),await e.sleep(50),i.value=!1},m=async(t,l,n)=>{var _,v;try{let c=((_=e==null?void 0:e.penitenciaria)==null?void 0:_.id)??null,y=((v=e==null?void 0:e.penitenciaria)==null?void 0:v.description)??null,h=e.historyId;if(n&&(c=t,y=l),h&&c){i.value=!0;let T=await O({historyId:h,carcelId:c,categoryId:p,subCategoryId:24});const a=[];T.map(u=>{a.push(u.pound)}),console.log(a);const C=[a[0]+a[2]],g=a.reduce((u,E)=>u+E,0);console.log(g),d.value=((a[0]+a[2])/g*100).toFixed(1),s.push($(c,y,C))}}catch(c){console.log(c)}finally{n||(i.value=!1)}},A=async()=>{i.value=!0,e.carcelesSelected&&e.carcelesSelected.length>0&&await Promise.all(e.carcelesSelected.map(async t=>await m(t.id,t.description,!0))),i.value=!1};return(t,l)=>(x(),S(R,{class:"contenedor-reincidencia"},{default:P(()=>[r(Y,{title:f.value,"section-value":p},null,8,["title"]),r(B,{"active-spin":i.value},null,8,["active-spin"]),r(z,{baseFilter:p,monthDisabled:!0,multipleDisabled:!1,onExecuteMount:A,onExecuteAction:m,onExecuteRemove:k}),I("div",W,[r(X,{class:"subsection-funcionarios",title:f.value,"section-value":p,pointValue:d.value,pointTitle:"Internos reincidentes en cada recinto",pointSubtitle:"Proporción (%) Internos reincidentes en cada recinto","point-is-percent":!0,"point-type":2},null,8,["title","pointValue","pointSubtitle"]),I("div",j,[i.value?L("",!0):(x(),S(H,{key:0,chartType:"bar",optionsAxisX:w.value,optionsAxisY:D.value,plotOptions:F.value,tooltip:V.value,series:s},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))])])]),_:1}))}};export{te as default};
