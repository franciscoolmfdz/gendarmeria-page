import{u as G,g as s,h as J,o as b,f as $,j as g,_ as K,x as O,l as x,b as u,m as r,n as Q,c as k,C as W,a as M,e as X,y as Y}from"./index-c6cfe71e.js";import{_ as Z}from"./subSideNav-9af33995.js";import{_ as ee}from"./CHeaderBar-341e9f0f.js";import{a as j}from"./CChartDonutSection-964682c9.js";import{_ as B}from"./CButton-a5ed5892.js";import{_ as I}from"./CTable-9f8a4cb1.js";import{s as ae}from"./filterSituacion-cddc3f3c.js";const oe={class:"content-header-profesionales"},te={key:0,class:"selected-options"},se={key:1,class:"c-option-volver"},le={class:"table-section-principal"},ne={class:"table-section"},ie={class:"content__section"},re=u("span",{class:"card-title"},"Dotación efectiva del personal psicología",-1),ce={class:"content__section"},ue=u("span",{class:"card-title"},"Dotación efectiva del personal asistente social",-1),de={class:"content__section"},fe=u("span",{class:"card-title"},"Dotación efectiva Total",-1),y=3,E=28,Pe={__name:"profesionales",setup(pe){const T=G(),d=s(null),l=ae(),c=s({id:15,description:"Región Metropolitana de Santiago"}),R=s(null),f=s(null),C=s(null),p=s([]),F=s([{rowReference:"title",description:"Totales"},{rowReference:"totalProfesionalHombre",description:"Hombre"},{rowReference:"totalProfesionalMujer",description:"Mujer"},{rowReference:"total",description:"Total"}]),h=s(0),P=s([]),D=s("Estado situación carcelaria / Personal de reinserción"),S=s([{rowReference:"carcel",description:"Establecimiento penal"},{rowReference:"profesionalHombre",description:"Hombre"},{rowReference:"profesionalMujer",description:"Mujer"}]),v=s([]),_=s([]),A=()=>{X.push("/situacionCarcelaria")},L=async a=>{if(!l.listadoRegiones.length>0){let n=await O();P.value=n,l.setRegionesList(n)}else P.value=l.listadoRegiones},N=async()=>{var n,i;let a={categoryId:y,historySubCategoryId:E,lastPeriod:!0};return h.value||(h.value=await x(a)),a={categoryId:y,historySubCategoryId:E,historyId:h.value.id,embedProfesionals:!0},c.value?a.regionId=(n=c.value)!=null&&n.id?c.value.id:c.value:(i=l==null?void 0:l.regionSelected)!=null&&i.id&&(a.regionId=l.regionSelected.id,c.value=l.regionSelected),f.value&&(a.carcelId=f.value),await U(),a},V=async()=>{try{if(c.value){p.value=[];const a=await N();let i=(await x(a)).items.map(e=>{const q=l.listadoCarceles.find(z=>z.id==e.carcelId);return e.carcel=q.description,e.totalProfesionalHombre=e.totalProfesionalHombre?e.totalProfesionalHombre:"0",e.profesionalMujer=e.profesionalMujer?e.profesionalMujer:"0",e}),o=0,t=0,w=0,H=0,m=0;v.value=i.filter(e=>e.profesionalTypeId===1).map(e=>(o+=e.profesionalHombre,t+=e.profesionalMujer,e.totalProfesionalHombre=e.totalProfesionalHombre?e.totalProfesionalHombre:"0",e.profesionalMujer=e.profesionalMujer?e.profesionalMujer:"0",e)),p.value.push({title:"Total personal psicología",totalProfesionalHombre:{class:"sub-value",data:o||"0"},totalProfesionalMujer:{class:"sub-value",data:t||"0"},total:o+t}),v.value.push({id:999,carcel:{data:"Total",class:"total"},profesionalHombre:{data:o,class:"total"},profesionalMujer:{data:t,class:"total"},profesionalTypeId:1}),w+=o,H+=t,m+=o+t,o=0,t=0,_.value=i.filter(e=>e.profesionalTypeId===2).map(e=>(o+=e.profesionalHombre,t+=e.profesionalMujer,e)),w+=o,H+=t,m+=o+t,C.value=m+" profesionales",p.value.push({title:"Total personal asistente social",totalProfesionalHombre:{class:"sub-value",data:o??"0"},totalProfesionalMujer:{class:"sub-value",data:t??"0"},total:o+t}),p.value.push({title:{class:"total",data:"Total dotación personal"},totalProfesionalHombre:{data:w,class:"total"},totalProfesionalMujer:{data:H,class:"total"},total:{data:m,class:"total"}}),_.value.push({id:999,carcel:{data:"Total",class:"total"},profesionalHombre:{data:o,class:"total"},profesionalMujer:{data:t,class:"total"},profesionalTypeId:2})}else v.value=[],_.value=[]}catch(a){console.log(a)}},U=async()=>{if(!l.listadoCarceles.length){let a=await Y();l.setCarcelesList(a)}};return J(async()=>{d.value=!0;const a=T.user.restrictions.find(i=>i.typeId===2),n=T.user.restrictions.find(i=>i.typeId===3);a?(R.value=parseInt(a.restriction),c.value=l.regionSelected.id):n?f.value=parseInt(n.restriction):(f.value=null,R.value=null),await L(),await V(),d.value=!1}),(a,n)=>(b(),$(K,{class:"contenido-profesionales"},{default:g(()=>[u("div",oe,[r(ee,{title:D.value,"section-value":y},null,8,["title"]),r(Q,{"active-spin":d.value},null,8,["active-spin"]),!d.value&&!f.value?(b(),k("div",te,[d.value?M("",!0):(b(),$(W,{key:0,ref:"region",class:"select-region",options:P.value,modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=i=>c.value=i)},null,8,["options","modelValue"])),r(B,{class:"btn-search",title:"",onExecuteAction:V})])):M("",!0),!d.value&&a.topPosition!==0?(b(),k("div",se,[r(B,{class:"btn-volver",title:"Volver",onExecuteAction:A})])):M("",!0)]),u("div",le,[r(Z,{class:"subsection-profesional",title:D.value,"point-type":3,"section-value":y,"point-label":C.value,pointTitle:"Personal de reinserción",pointSubtitle:"","point-disabled":!0},null,8,["title","point-label"]),u("div",ne,[u("div",ie,[r(j,{class:"card-information"},{default:g(()=>[re]),_:1}),r(I,{class:"table-psicologia",columns:S.value,rows:v.value},null,8,["columns","rows"])]),u("div",ce,[r(j,{class:"card-information"},{default:g(()=>[ue]),_:1}),r(I,{class:"table-asistente",columns:S.value,rows:_.value},null,8,["columns","rows"])]),u("div",de,[r(j,{class:"card-information"},{default:g(()=>[fe]),_:1}),r(I,{class:"table-asistente",columns:F.value,rows:p.value},null,8,["columns","rows"])])])])]),_:1}))}};export{Pe as default};
