import{u as k,g as i,h as B,o as p,f as y,j as x,_ as L,q as N,l as I,m as n,b as f,x as J,a as C,c as T,e as z,C as H}from"./index-caf32ba9.js";import{_ as O}from"./CHeaderBar-d352756e.js";import{_ as j}from"./subSideNav-a58b3954.js";import{_ as S}from"./CButton-98714c16.js";import{_ as q}from"./CTable-0b9142cc.js";import{s as U}from"./filterSituacion-e46a409d.js";import"./CChartDonutSection-6897dea7.js";const G={class:"selected-options"},K={key:0,class:"c-option-volver"},Q={class:"table-section-principal"},W={class:"content__section"},c=3,D=32,se={__name:"partesDenuncia",setup(X){const o=U(),m=k(),v=i(!1),r=i({id:15,description:"Región Metropolitana de Santiago"}),g=i([]),u=i(0),s=i(null),l=i(null),_=i(""),w=i("Estado situación carcelaria / Resumen partes ley 20.000"),V=i([{description:"Centro penitenciario",colspan:1},{description:_,colspan:12},{description:"Resumen",colspan:3}]),h=i([{rowReference:"establecimiento",description:"Establecimiento"},{rowReference:"dataEnero",description:"Enero"},{rowReference:"dataFebrero",description:"Feb"},{rowReference:"dataMarzo",description:"Marzo"},{rowReference:"dataAbril",description:"Abril"},{rowReference:"dataMayo",description:"Mayo"},{rowReference:"dataJunio",description:"Junio"},{rowReference:"dataJulio",description:"Julio"},{rowReference:"dataAgosto",description:"Agosto"},{rowReference:"dataSeptiembre",description:"Septiembre"},{rowReference:"dataOctubre",description:"Octubre"},{rowReference:"dataNoviembre",description:"Nombiembre"},{rowReference:"dataDiciembre",description:"Diciembre"},{rowReference:"leyVeinteMil",description:"Ley 20.000"},{rowReference:"total",description:"Total"}]),d=i([]),$=()=>{z.push("/situacionCarcelaria")},A=async()=>{o.changeRegionSelected(r.value),await b(),await R()},E=async e=>{if(!o.listadoRegiones.length>0){let t={regionId:null};s.value&&(t.regionId=s.value);let a=await N(t);g.value=a,o.setRegionesList(a)}},b=async()=>{const e={regionId:o.regionSelected.id};let t=await H(e);o.setCarcelesList(t)},F=async()=>{var t;let e={categoryId:c,subCategoryId:D,lastPeriod:!0};return u.value||(u.value=await I(e)),e={categoryId:c,subCategoryId:D,historyId:u.value.id,embedLawParts:!0},s.value?e.regionId=s.value:(t=o==null?void 0:o.regionSelected)!=null&&t.id&&(e.regionId=o.regionSelected.id),l.value&&(e.carcelId=l.value),await b(),e},R=async()=>{try{const e=await F(),t=await I(e);_.value=`Año ${t.period}`,d.value=t.items.map(a=>{const M=o.listadoCarceles.find(P=>P.id==a.carcelId);return a.establecimiento=M.description,a}),console.log(d.value)}catch(e){console.log(e)}};return B(async()=>{const e=m.user.restrictions.find(a=>a.typeId===2),t=m.user.restrictions.find(a=>a.typeId===3);e?s.value=parseInt(e.restriction):t?l.value=parseInt(t.restriction):(l.value=null,s.value=null),r.value=o.regionSelected.value,await E(),await R(),v.value=!0}),(e,t)=>(p(),y(L,{class:"contenido-partes"},{default:x(()=>[n(O,{title:w.value,"section-value":c},null,8,["title"]),f("div",G,[v.value?(p(),y(J,{key:0,class:"select-region",options:g.value,modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=a=>r.value=a)},null,8,["options","modelValue"])):C("",!0),n(S,{class:"btn-search",title:"",onExecuteAction:t[1]||(t[1]=a=>A())})]),!e.activeSpin&&e.topPosition!==0?(p(),T("div",K,[n(S,{class:"btn-volver",title:"Volver",onExecuteAction:$,disabled:e.blockButton},null,8,["disabled"])])):C("",!0),f("div",Q,[n(j,{class:"subsection-partes",title:w.value,"section-value":c,pointValue:e.pointCalculated,pointTitle:"Partes denuncia ley 20.000",pointSubtitle:""},null,8,["title","pointValue"]),f("div",W,[n(q,{"parent-columns":V.value,columns:h.value,rows:d.value},null,8,["parent-columns","columns","rows"])])])]),_:1}))}};export{se as default};
