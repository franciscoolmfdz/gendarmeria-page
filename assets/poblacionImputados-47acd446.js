import{g as c,h as G,o as f,f as V,j as J,_ as K,x as O,l as S,b as H,m as d,n as Q,c as k,C as W,a as g,e as X,y as Y}from"./index-c5d31a8d.js";import{_ as Z}from"./subSideNav-70a9c1a2.js";import{_ as ee}from"./CHeaderBar-cec87e9b.js";import{_ as $}from"./CButton-a8f847be.js";import{_ as ae}from"./CTable-695503ac.js";import{s as oe}from"./filterSituacion-3453f87a.js";import"./CChartDonutSection-16a850f5.js";const te={class:"content-imputados"},se={key:0,class:"selected-options"},ne={key:1,class:"c-option-volver"},ce={class:"table-section-principal"},re={class:"content__section"},M=3,B=30,fe={__name:"poblacionImputados",setup(ie){const t=oe(),w=c("Estado situación carcelaria / Tasa de ocupación"),D=c(!1),o=c({id:15,description:"Región Metropolitana de Santiago"});c();const C=c(),_=c([]),j=c(0),m=c(!1),u=c(0),N=c([{description:"Centro penitenciario",colspan:1},{description:"Condenados",colspan:3},{description:"Imputados",colspan:3},{description:"Total PPL. 24h",colspan:3},{description:"Capacidad según diseño (Incluye 24 hrs y juveniles)",colspan:1},{description:"% Uso capacidad total",colspan:3}]),E=c([{rowReference:"establecimiento",description:""},{rowReference:"condenadoHombre",description:"Hombre"},{rowReference:"condenadoMujer",description:"Mujer"},{rowReference:"condenadoTotal",description:"Total"},{rowReference:"imputadoHombre",description:"Hombre"},{rowReference:"imputadoMujer",description:"Mujer"},{rowReference:"imputadoTotal",description:"Total"},{rowReference:"totalPplHombre",description:"Hombre"},{rowReference:"totalPplMujer",description:"Mujer"},{rowReference:"totalPplTotal",description:"Total"},{rowReference:"capacidadTotal",description:"Total"},{rowReference:"usoCapacidadHombre",description:"Hombre"},{rowReference:"usoCapacidadMujer",description:"Mujer"},{rowReference:"usoCapacidadTotal",description:"Total"}]),b=c([]),L=()=>{X.push("/situacionCarcelaria")},i=e=>e?Math.round(e*100)/100:0,l=e=>e<85?"class-verde":e>85&&e<99?"class-ambar":"class-rojo",A=e=>{const a=t.listadoCarceles.find(z=>z.id===e.carcelId),s=e.imputadoHombre+e.condenadoHombre+e.procesadoHombre+e.detenidoHombre,n=e.imputadoMujer+e.condenadoMujer+e.procesadoMujer+e.detenidoMujer,r=s+n,I=e.imputadoHombre+e.imputadoMujer,p=e.pplMaxMujer+e.pplMaxHombre,y=s&&e.pplMaxHombre?i(s*100/e.pplMaxHombre):0,x=n&&e.pplMaxMujer?i(n*100/e.pplMaxMujer):0,v=r&&p?i(r*100/p):0,h=e.imputadoHombre&&e.pplMaxHombre?i(e.imputadoHombre*100/e.pplMaxHombre):0,P=e.imputadoMujer&&e.pplMaxMujer?i(e.imputadoMujer*100/e.pplMaxMujer):0,R=I&&p?i(I*100/p):0;if(a&&(a!=null&&a.id))return u.value+=isNaN(v)?0:v,{carcelId:a.id,establecimiento:a.description,condenadoHombre:{data:e.condenadoHombre,class:"ppl-datatable"},condenadoMujer:{data:e.condenadoMujer,class:"ppl-datatable"},condenadoTotal:{data:e.condenadoHombre+e.condenadoMujer,class:"ppl-datatable"},imputadoHombre:e.imputadoHombre,imputadoMujer:e.imputadoMujer,imputadoTotal:e.imputadoMujer+e.imputadoHombre,totalPplHombre:{data:s,class:"ppl-datatable"},totalPplMujer:{data:n,class:"ppl-datatable"},totalPplTotal:{data:s+n,class:"ppl-datatable"},capacidadHombre:e.pplMaxHombre,capacidadMujer:e.pplMaxMujer,capacidadTotal:{data:p,class:"diseno-datatable"},usoCapacidadHombre:{data:y+"%",class:l(y)},usoCapacidadMujer:{data:x+"%",class:l(x)},usoCapacidadTotal:{data:v+"%",class:l(v)},usoImputadoHombre:{data:h+"%",class:l(h)},usoImputadoMujer:{data:P+"%",class:l(P)},usoImputadoTotal:{data:R+"%",class:l(R)}}},F=async e=>{if(!t.listadoRegiones.length>0){let a=await O();_.value=a,t.setRegionesList(a)}else _.value=t.listadoRegiones},U=async()=>{let e=await Y();t.setCarcelesList(e)},q=async()=>{var a,s,n;let e={categoryId:M,historySubCategoryId:B,lastPeriod:!0};return j.value||(j.value=await S(e)),e={categoryId:M,historySubCategoryId:B,historyId:j.value.id,embedPopulation:!0},o.value?e.regionId=(a=o.value)!=null&&a.id?o.value.id:o.value:(s=t==null?void 0:t.regionSelected)!=null&&s.id?(e.regionId=t.regionSelected.id,o.value=t.regionSelected):o!=null&&o.value&&(e.regionId=(n=o==null?void 0:o.value)!=null&&n.id?o.value.id:o==null?void 0:o.value),C.value&&(e.carcelId=C.value),await U(),e},T=async()=>{var e,a;try{if(u.value=0,(e=t==null?void 0:t.regionSelected)!=null&&e.id){const s=await q();let n=await S(s);(a=n==null?void 0:n.items)!=null&&a.length?b.value=n.items.map(r=>A(r)).filter(r=>r==null?void 0:r.carcelId):b.value=[],u.value=(u.value/b.value.length).toFixed(1)}}catch(s){console.log(s)}};return G(async()=>{o.value=t.regionSelected,await F(),await T(),D.value=!0}),(e,a)=>(f(),V(K,{class:"contenido-imputados"},{default:J(()=>[H("div",te,[d(ee,{title:w.value,"section-value":M},null,8,["title"]),d(Q,{"active-spin":m.value},null,8,["active-spin"]),m.value?g("",!0):(f(),k("div",se,[m.value?g("",!0):(f(),V(W,{key:0,class:"select-region",options:_.value,modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value=s)},null,8,["options","modelValue"])),d($,{class:"btn-search",title:"",onExecuteAction:T})])),!m.value&&e.topPosition!==0?(f(),k("div",ne,[d($,{class:"btn-volver",title:"Volver",onExecuteAction:L,disabled:e.blockButton},null,8,["disabled"])])):g("",!0)]),H("div",ce,[d(Z,{class:"subsection-imputados",title:w.value,"section-value":M,pointValue:u.value,pointTitle:"Tasa de ocupación",pointSubtitle:"","point-is-percent":!0,"point-type":2},null,8,["title","pointValue"]),H("div",re,[d(ae,{"parent-columns":N.value,columns:E.value,rows:b.value},null,8,["parent-columns","columns","rows"])])])]),_:1}))}};export{fe as default};
