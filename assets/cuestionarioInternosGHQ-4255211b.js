import{u as B,g as u,r as I,o as w,f as P,j as G,_ as E,m as g,n as R,b as d,a as T,l as N}from"./index-60abcd12.js";import{_ as O}from"./subSideNav-e25f03bc.js";import{a as X}from"./CChartDonutSection-254b1a03.js";import{_ as Y}from"./CHeaderBar-2f735b52.js";import{_ as j}from"./CFilterbar-80d88b3a.js";import{_ as z}from"./CColunmChart-18498762.js";import"./CButton-175216dd.js";const M={class:"chart-section-principal"},W={class:"cuestionario-ghq"},J={class:"chart-section"},K=d("span",{class:"card-title"},"Escala de evaluación",-1),U=d("span",{class:"question--value"},"Ausencia de psicopatología: 0 a 2 puntos.",-1),Z=d("span",{class:"question--value"},"Sospecha de psicopatología: 3 a 6 puntos.",-1),ee=d("span",{class:"question--value"},"Presencia de psicopatología: 7 ó mas puntos.",-1),b=1,ce={__name:"cuestionarioInternosGHQ",setup(te){const s=B(),r=u(!1),x=u("Calidad de vida de los internos / Cuestionario de Salud GHQ-12 de Goldberg"),v=u([]),F=u(0),D=u({categories:["Ausencia","Sospecha","Presencia"],crosshair:!1}),A=u({min:0,allowDecimals:!1,title:{text:"Porcentaje de la población"}}),C=["#6ad172","#337e4c","#878787"],H=u({column:{pointPadding:.2,borderWidth:3}}),$=u({headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.1f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0}),f=I([]),Q=(e,t,o)=>I({id:e,name:t,data:o,colorByPoint:!0,dataLabels:{enabled:!0,color:"#000",align:"center",x:11,pointFormat:'<tr><td style="padding:0"><b>{point.y}%</b></td></tr>',style:{inside:!1,fontSize:"12px",bold:800,fontFamily:"helvetica, arial, sans-serif",textShadow:!0,fontWeight:"bold"}}}),L=async e=>{r.value=!0;const t=f.filter(o=>o.id!==e);v.value=v.value.filter(o=>o.carcelId!=e),S(),f.splice(0,f.length),t.map(o=>f.push(o)),await s.sleep(50),r.value=!1},m=e=>e?Math.round(e*100)/100:0,S=()=>{let e=v.value.reduce((t,o)=>t!=null&&t.pointValue?t.pointValue.map((i,l)=>i+o.pointValue[l]):t.map((i,l)=>i+o.pointValue[l]));e=(e==null?void 0:e.pointValue)??e,e=e.map(t=>parseFloat((t/v.value.length).toFixed(1))),F.value=e},k=(e,t)=>{let o=e[0].recordId,i=0,l=0,a=0,n=0,_=0,y=0;for(let h=0;h<e.length;h++){let p=e[h];p.pound>=0&&(_+=p.pound,y++),p.recordId==o&&p.pound>=0?n+=p.pound:(n<2?i++:n>2&&n<=6?l++:n>6&&a++,n=p.pound,o=p.recordId)}_=_*10/y;const c=i+l+a;return v.value.push({carcelId:t,pointValue:[parseFloat(m(i/c*100).toFixed(1)),parseFloat(m(l/c*100).toFixed(1)),parseFloat(m(a/c*100).toFixed(1))]}),S(),[parseFloat(m(i/c*100).toFixed(1)),parseFloat(m(l/c*100).toFixed(1)),parseFloat(m(a/c*100).toFixed(1))]},V=async(e,t,o)=>{var i,l;try{let a=((i=s==null?void 0:s.penitenciaria)==null?void 0:i.id)??null,n=((l=s==null?void 0:s.penitenciaria)==null?void 0:l.description)??null,_=s.historyId;if(o&&(a=e,n=t),_&&a){r.value=!0;let c=await N({historyId:_,carcelId:a,categoryId:1,subCategoryId:21,embedDetail:!0});const h=k(c.items,a);f.push(Q(a,n,h))}}catch(a){console.log(a)}finally{o||(r.value=!1)}},q=async()=>{r.value=!0,s.carcelesSelected&&s.carcelesSelected.length>0&&await Promise.all(s.carcelesSelected.map(async e=>await V(e.id,e.description,!0))),r.value=!1};return(e,t)=>(w(),P(E,null,{default:G(()=>[g(Y,{title:x.value,"section-value":b},null,8,["title"]),g(R,{"active-spin":r.value},null,8,["active-spin"]),g(j,{baseFilter:b,multipleDisabled:!1,onExecuteMount:q,onExecuteAction:V,onExecuteRemove:L}),d("div",M,[g(O,{title:x.value,"section-value":b,piePoints:F.value,"point-type":5,circleDisabled:!0,pointTitle:"Cuestionario General de Salud GHQ-12 de Goldberg",pointSubtitle:"Promedio respuestas cuestionario General de Salud GHQ-12 de Goldberg"},null,8,["title","piePoints"]),d("div",W,[d("div",J,[r.value?T("",!0):(w(),P(z,{key:0,chartType:"bar",optionsAxisX:D.value,optionsAxisY:A.value,plotOptions:H.value,tooltip:$.value,series:f,colorList:C},null,8,["optionsAxisX","optionsAxisY","plotOptions","tooltip","series"]))]),g(X,{class:"card-preguntas"},{default:G(()=>[K,U,Z,ee]),_:1})])])]),_:1}))}};export{ce as default};
