import{s as I,g as l,h as L,i as A,o as D,f as x,j as p,_ as G,x as V,y as F,l as m,m as d,n as k,b as e}from"./index-b59ede32.js";import{_ as y,a as B}from"./CChartDonutSection-28744a53.js";import{_ as j}from"./CHeaderBar-350039dd.js";import{_ as M}from"./CTable-fea1d5e6.js";import{s as N}from"./filterSituacion-91b300b3.js";const R="/dmm/dimension-history-program",U=async(o,n)=>{if(o!=null&&o.id){let g=`${R}/${o.id}`;return I(g,"GET",null,n)}let u=R,t=null;return o!=null&&o.regionId&&(t?t=`${t}&regionId=${o.regionId}`:t=`regionId=${o.regionId}`),o!=null&&o.carcelId&&(t?t=`${t}&carcelId=${o.carcelId}`:t=`carcelId=${o.carcelId}`),o!=null&&o.historyId&&(t?t=`${t}&historyId=${o.historyId}`:t=`historyId=${o.historyId}`),t&&(u=`${u}?${t}`),I(u,"GET",null,n)};const H={class:"information-section-program"},q=e("span",{class:"sub-menu__option--title"}," Ver más ",-1),z=e("span",{class:"sub-menu__option--title"}," Ver más ",-1),K={class:"information__section"},O=e("span",{class:"card-title"},"Programas",-1),Q=e("div",{class:"card-subsection"},[e("span",{class:"card-subtitle"},"PPL :"),e("span",null," Programa de reinserción social para personas privadas de libertad")],-1),W=e("div",{class:"card-subsection"},[e("span",{class:"card-subtitle"},"PRS :"),e("span",null," Programa Ministerio del Interior")],-1),X=e("div",{class:"card-subsection"},[e("span",{class:"card-subtitle"},"CET C :"),e("span",null," CET Cerrado")],-1),Y=e("div",{class:"card-subsection"},[e("span",{class:"card-subtitle"},"CET S :"),e("span",null," CET Semiabierto")],-1),Z=e("div",{class:"card-subsection"},[e("span",{class:"card-subtitle"},"CTA :"),e("span",null," Centro de tratamiento de adicciones")],-1),ee=e("div",{class:"card-subsection"},[e("span",{class:"card-subtitle"},"SSJJ :"),e("span",null," Secciones Juveniles")],-1),se=e("div",{class:"card-subsection"},[e("span",{class:"card-subtitle"},"CJ :"),e("span",null," Creciendo Juntos")],-1),oe={class:"content__section table-program"},te=4,le={__name:"ElementosReinsercion",setup(o){const n=N(),u=l(!1),t=l([]),g=l([]),b=l("Elementos de reinserción"),f=l(null),v=l(null),P=l([{rowReference:"region",description:"Región",class:"region"},{rowReference:"carcel",description:"Establecimiento penal"},{rowReference:"programPPL",description:"PPL"},{rowReference:"programPLS",description:"PRS"},{rowReference:"programCETC",description:"CET C"},{rowReference:"programCETSA",description:"CET SA"},{rowReference:"programCTA",description:"CTA"},{rowReference:"programSSJJ",description:"SSJJ"},{rowReference:"programCJ",description:"CJ"},{rowReference:"total",description:"Total en funcionamiento"}]),h=l([]),S=async()=>{if(!n.listadoRegiones.value||n.listadoRegiones.length>0){let a=await V();t.value=a,n.setRegionesList(a)}else t.value=n.listadoRegiones;if(!n.listadoCarceles.value||n.listadoCarceles.length>0){let a=await F();g.value=a,n.setRegionesList(a)}else g.value=n.listadoCarceles},w=async()=>{const i={historyId:(await m({categoryId:4,historySubCategoryId:25,lastPeriod:!0})).id,embed:"reinsercion",procesalTypeId:1,regimenStateId:2},c=await m(i);T(c.items),E(c.items)},T=a=>{try{const r=a.length,i=a.filter(c=>c.condenaPrevia).length;f.value=parseFloat((i/r*100).toFixed(1))??0}catch(r){console.log(r)}},E=a=>{try{const r=a.length,i=a.filter(c=>c.igi).length;v.value=parseFloat((i/r*100).toFixed(1))}catch(r){console.log(r)}},$=async()=>{try{const i={historyId:(await m({categoryId:4,historySubCategoryId:26,lastPeriod:!0})).id},c=await U(i);h.value=c.map(s=>{const J=t.value.find(_=>_.id===s.regionId);s.region={data:J.shortDescription,class:"region"},console.log(s.centroId);const C=g.value.find(_=>_.id===s.centroId);return console.log(C),s.carcel=C.description,s.programPPL=s.programPPL?{data:".",class:"data-circle"}:"",s.programPLS=s.programPLS?{data:".",class:"data-circle"}:"",s.programCETC=s.programCETC?{data:".",class:"data-circle"}:"",s.programCETSA=s.programCETSA?{data:".",class:"data-circle"}:"",s.programCTA=s.programCTA?{data:".",class:"data-circle"}:"",s.programSSJJ=s.programSSJJ?{data:".",class:"data-circle"}:"",s.programCJ=s.programCJ?{data:".",class:"data-circle"}:"",s.total={data:s.total,class:"value-total"},s.promedio={data:s.promedio,class:"value-total"},s})}catch(a){console.log(a)}};return L(async()=>{u.value=!0;try{await S(),await $(),await w()}catch(a){console.log(a)}finally{u.value=!1}}),(a,r)=>{const i=A("RouterLink");return D(),x(G,{class:"contenedor-reinsercion"},{default:p(()=>[d(j,{title:b.value,"section-value":te},null,8,["title"]),d(k,{"active-spin":u.value},null,8,["active-spin"]),e("div",H,[d(y,{class:"section-donut",title:"Porcentaje de reincidencia","point-value":f.value,type:2,"is-percent":!0},{default:p(()=>[d(i,{to:"situacionReincidencia",class:"sub-menu--option white btn-small"},{default:p(()=>[q]),_:1})]),_:1},8,["point-value"]),d(y,{class:"section-donut",title:"Internos con IGI","point-value":v.value,type:2,"is-percent":!0},{default:p(()=>[d(i,{to:"regimenProcesal",class:"sub-menu--option white btn-small"},{default:p(()=>[z]),_:1})]),_:1},8,["point-value"]),e("div",K,[d(B,{class:"card-information card-program"},{default:p(()=>[O,Q,W,X,Y,Z,ee,se]),_:1})])]),e("div",oe,[d(M,{columns:P.value,rows:h.value},null,8,["columns","rows"])])]),_:1})}}};export{le as default};
